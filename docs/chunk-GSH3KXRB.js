import{a as Qt}from"./chunk-JYUCKSLI.js";import{a as ve,b as Dt,d as W,e as A}from"./chunk-KNB5IV62.js";import{d as Bt,g as yt}from"./chunk-64UY4ISW.js";import{i as Pt,k as $e,o as St,q as at}from"./chunk-U2BKPXLL.js";import{D as wt,H as Xt,J as tt,K as Yt,L as Vt,N as ke,O as Me,_ as U,ba as Zt,h as k,j as Q,ja as K,v as Se}from"./chunk-KEUU4GSS.js";import{a as st,b as lt,g as L}from"./chunk-7IQ7MVDA.js";function Jt(l,t,r){if(l&&l.length){let[s,e]=t,i=Math.PI/180*r,h=Math.cos(i),a=Math.sin(i);for(let o of l){let[n,c]=o;o[0]=(n-s)*h-(c-e)*a+s,o[1]=(n-s)*a+(c-e)*h+e}}}function ra(l,t){return l[0]===t[0]&&l[1]===t[1]}function ia(l,t,r,s=1){let e=r,i=Math.max(t,.1),h=l[0]&&l[0][0]&&typeof l[0][0]=="number"?[l]:l,a=[0,0];if(e)for(let n of h)Jt(n,a,e);let o=function(n,c,p){let f=[];for(let x of n){let w=[...x];ra(w[0],w[w.length-1])||w.push([w[0][0],w[0][1]]),w.length>2&&f.push(w)}let g=[];c=Math.max(c,.1);let u=[];for(let x of f)for(let w=0;w<x.length-1;w++){let b=x[w],v=x[w+1];if(b[1]!==v[1]){let S=Math.min(b[1],v[1]);u.push({ymin:S,ymax:Math.max(b[1],v[1]),x:S===b[1]?b[0]:v[0],islope:(v[0]-b[0])/(v[1]-b[1])})}}if(u.sort((x,w)=>x.ymin<w.ymin?-1:x.ymin>w.ymin?1:x.x<w.x?-1:x.x>w.x?1:x.ymax===w.ymax?0:(x.ymax-w.ymax)/Math.abs(x.ymax-w.ymax)),!u.length)return g;let y=[],m=u[0].ymin,d=0;for(;y.length||u.length;){if(u.length){let x=-1;for(let w=0;w<u.length&&!(u[w].ymin>m);w++)x=w;u.splice(0,x+1).forEach(w=>{y.push({s:m,edge:w})})}if(y=y.filter(x=>!(x.edge.ymax<=m)),y.sort((x,w)=>x.edge.x===w.edge.x?0:(x.edge.x-w.edge.x)/Math.abs(x.edge.x-w.edge.x)),(p!==1||d%c==0)&&y.length>1)for(let x=0;x<y.length;x+=2){let w=x+1;if(w>=y.length)break;let b=y[x].edge,v=y[w].edge;g.push([[Math.round(b.x),m],[Math.round(v.x),m]])}m+=p,y.forEach(x=>{x.edge.x=x.edge.x+p*x.edge.islope}),d++}return g}(h,i,s);if(e){for(let n of h)Jt(n,a,-e);(function(n,c,p){let f=[];n.forEach(g=>f.push(...g)),Jt(f,c,p)})(o,a,-e)}return o}function Nt(l,t){var r;let s=t.hachureAngle+90,e=t.hachureGap;e<0&&(e=4*t.strokeWidth),e=Math.round(Math.max(e,.1));let i=1;return t.roughness>=1&&(((r=t.randomizer)===null||r===void 0?void 0:r.next())||Math.random())>.7&&(i=e),ia(l,e,s,i||1)}var Lt=class{constructor(t){this.helper=t}fillPolygons(t,r){return this._fillPolygons(t,r)}_fillPolygons(t,r){let s=Nt(t,r);return{type:"fillSketch",ops:this.renderLines(s,r)}}renderLines(t,r){let s=[];for(let e of t)s.push(...this.helper.doubleLineOps(e[0][0],e[0][1],e[1][0],e[1][1],r));return s}};function Gt(l){let t=l[0],r=l[1];return Math.sqrt(Math.pow(t[0]-r[0],2)+Math.pow(t[1]-r[1],2))}var se=class extends Lt{fillPolygons(t,r){let s=r.hachureGap;s<0&&(s=4*r.strokeWidth),s=Math.max(s,.1);let e=Nt(t,Object.assign({},r,{hachureGap:s})),i=Math.PI/180*r.hachureAngle,h=[],a=.5*s*Math.cos(i),o=.5*s*Math.sin(i);for(let[n,c]of e)Gt([n,c])&&h.push([[n[0]-a,n[1]+o],[...c]],[[n[0]+a,n[1]-o],[...c]]);return{type:"fillSketch",ops:this.renderLines(h,r)}}},ae=class extends Lt{fillPolygons(t,r){let s=this._fillPolygons(t,r),e=Object.assign({},r,{hachureAngle:r.hachureAngle+90}),i=this._fillPolygons(t,e);return s.ops=s.ops.concat(i.ops),s}},re=class{constructor(t){this.helper=t}fillPolygons(t,r){let s=Nt(t,r=Object.assign({},r,{hachureAngle:0}));return this.dotsOnLines(s,r)}dotsOnLines(t,r){let s=[],e=r.hachureGap;e<0&&(e=4*r.strokeWidth),e=Math.max(e,.1);let i=r.fillWeight;i<0&&(i=r.strokeWidth/2);let h=e/4;for(let a of t){let o=Gt(a),n=o/e,c=Math.ceil(n)-1,p=o-c*e,f=(a[0][0]+a[1][0])/2-e/4,g=Math.min(a[0][1],a[1][1]);for(let u=0;u<c;u++){let y=g+p+u*e,m=f-h+2*Math.random()*h,d=y-h+2*Math.random()*h,x=this.helper.ellipse(m,d,i,i,r);s.push(...x.ops)}}return{type:"fillSketch",ops:s}}},ie=class{constructor(t){this.helper=t}fillPolygons(t,r){let s=Nt(t,r);return{type:"fillSketch",ops:this.dashedLine(s,r)}}dashedLine(t,r){let s=r.dashOffset<0?r.hachureGap<0?4*r.strokeWidth:r.hachureGap:r.dashOffset,e=r.dashGap<0?r.hachureGap<0?4*r.strokeWidth:r.hachureGap:r.dashGap,i=[];return t.forEach(h=>{let a=Gt(h),o=Math.floor(a/(s+e)),n=(a+e-o*(s+e))/2,c=h[0],p=h[1];c[0]>p[0]&&(c=h[1],p=h[0]);let f=Math.atan((p[1]-c[1])/(p[0]-c[0]));for(let g=0;g<o;g++){let u=g*(s+e),y=u+s,m=[c[0]+u*Math.cos(f)+n*Math.cos(f),c[1]+u*Math.sin(f)+n*Math.sin(f)],d=[c[0]+y*Math.cos(f)+n*Math.cos(f),c[1]+y*Math.sin(f)+n*Math.sin(f)];i.push(...this.helper.doubleLineOps(m[0],m[1],d[0],d[1],r))}}),i}},ne=class{constructor(t){this.helper=t}fillPolygons(t,r){let s=r.hachureGap<0?4*r.strokeWidth:r.hachureGap,e=r.zigzagOffset<0?s:r.zigzagOffset,i=Nt(t,r=Object.assign({},r,{hachureGap:s+e}));return{type:"fillSketch",ops:this.zigzagLines(i,e,r)}}zigzagLines(t,r,s){let e=[];return t.forEach(i=>{let h=Gt(i),a=Math.round(h/(2*r)),o=i[0],n=i[1];o[0]>n[0]&&(o=i[1],n=i[0]);let c=Math.atan((n[1]-o[1])/(n[0]-o[0]));for(let p=0;p<a;p++){let f=2*p*r,g=2*(p+1)*r,u=Math.sqrt(2*Math.pow(r,2)),y=[o[0]+f*Math.cos(c),o[1]+f*Math.sin(c)],m=[o[0]+g*Math.cos(c),o[1]+g*Math.sin(c)],d=[y[0]+u*Math.cos(c+Math.PI/4),y[1]+u*Math.sin(c+Math.PI/4)];e.push(...this.helper.doubleLineOps(y[0],y[1],d[0],d[1],s),...this.helper.doubleLineOps(d[0],d[1],m[0],m[1],s))}}),e}},it={},le=class{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}},na=0,Kt=1,De=2,Wt={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function Ut(l,t){return l.type===t}function fe(l){let t=[],r=function(h){let a=new Array;for(;h!=="";)if(h.match(/^([ \t\r\n,]+)/))h=h.substr(RegExp.$1.length);else if(h.match(/^([aAcChHlLmMqQsStTvVzZ])/))a[a.length]={type:na,text:RegExp.$1},h=h.substr(RegExp.$1.length);else{if(!h.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];a[a.length]={type:Kt,text:`${parseFloat(RegExp.$1)}`},h=h.substr(RegExp.$1.length)}return a[a.length]={type:De,text:""},a}(l),s="BOD",e=0,i=r[e];for(;!Ut(i,De);){let h=0,a=[];if(s==="BOD"){if(i.text!=="M"&&i.text!=="m")return fe("M0,0"+l);e++,h=Wt[i.text],s=i.text}else Ut(i,Kt)?h=Wt[s]:(e++,h=Wt[i.text],s=i.text);if(!(e+h<r.length))throw new Error("Path data ended short");for(let o=e;o<e+h;o++){let n=r[o];if(!Ut(n,Kt))throw new Error("Param not a number: "+s+","+n.text);a[a.length]=+n.text}if(typeof Wt[s]!="number")throw new Error("Bad segment: "+s);{let o={key:s,data:a};t.push(o),e+=h,i=r[e],s==="M"&&(s="L"),s==="m"&&(s="l")}}return t}function Te(l){let t=0,r=0,s=0,e=0,i=[];for(let{key:h,data:a}of l)switch(h){case"M":i.push({key:"M",data:[...a]}),[t,r]=a,[s,e]=a;break;case"m":t+=a[0],r+=a[1],i.push({key:"M",data:[t,r]}),s=t,e=r;break;case"L":i.push({key:"L",data:[...a]}),[t,r]=a;break;case"l":t+=a[0],r+=a[1],i.push({key:"L",data:[t,r]});break;case"C":i.push({key:"C",data:[...a]}),t=a[4],r=a[5];break;case"c":{let o=a.map((n,c)=>c%2?n+r:n+t);i.push({key:"C",data:o}),t=o[4],r=o[5];break}case"Q":i.push({key:"Q",data:[...a]}),t=a[2],r=a[3];break;case"q":{let o=a.map((n,c)=>c%2?n+r:n+t);i.push({key:"Q",data:o}),t=o[2],r=o[3];break}case"A":i.push({key:"A",data:[...a]}),t=a[5],r=a[6];break;case"a":t+=a[5],r+=a[6],i.push({key:"A",data:[a[0],a[1],a[2],a[3],a[4],t,r]});break;case"H":i.push({key:"H",data:[...a]}),t=a[0];break;case"h":t+=a[0],i.push({key:"H",data:[t]});break;case"V":i.push({key:"V",data:[...a]}),r=a[0];break;case"v":r+=a[0],i.push({key:"V",data:[r]});break;case"S":i.push({key:"S",data:[...a]}),t=a[2],r=a[3];break;case"s":{let o=a.map((n,c)=>c%2?n+r:n+t);i.push({key:"S",data:o}),t=o[2],r=o[3];break}case"T":i.push({key:"T",data:[...a]}),t=a[0],r=a[1];break;case"t":t+=a[0],r+=a[1],i.push({key:"T",data:[t,r]});break;case"Z":case"z":i.push({key:"Z",data:[]}),t=s,r=e}return i}function We(l){let t=[],r="",s=0,e=0,i=0,h=0,a=0,o=0;for(let{key:n,data:c}of l){switch(n){case"M":t.push({key:"M",data:[...c]}),[s,e]=c,[i,h]=c;break;case"C":t.push({key:"C",data:[...c]}),s=c[4],e=c[5],a=c[2],o=c[3];break;case"L":t.push({key:"L",data:[...c]}),[s,e]=c;break;case"H":s=c[0],t.push({key:"L",data:[s,e]});break;case"V":e=c[0],t.push({key:"L",data:[s,e]});break;case"S":{let p=0,f=0;r==="C"||r==="S"?(p=s+(s-a),f=e+(e-o)):(p=s,f=e),t.push({key:"C",data:[p,f,...c]}),a=c[0],o=c[1],s=c[2],e=c[3];break}case"T":{let[p,f]=c,g=0,u=0;r==="Q"||r==="T"?(g=s+(s-a),u=e+(e-o)):(g=s,u=e);let y=s+2*(g-s)/3,m=e+2*(u-e)/3,d=p+2*(g-p)/3,x=f+2*(u-f)/3;t.push({key:"C",data:[y,m,d,x,p,f]}),a=g,o=u,s=p,e=f;break}case"Q":{let[p,f,g,u]=c,y=s+2*(p-s)/3,m=e+2*(f-e)/3,d=g+2*(p-g)/3,x=u+2*(f-u)/3;t.push({key:"C",data:[y,m,d,x,g,u]}),a=p,o=f,s=g,e=u;break}case"A":{let p=Math.abs(c[0]),f=Math.abs(c[1]),g=c[2],u=c[3],y=c[4],m=c[5],d=c[6];p===0||f===0?(t.push({key:"C",data:[s,e,m,d,m,d]}),s=m,e=d):(s!==m||e!==d)&&(He(s,e,m,d,p,f,g,u,y).forEach(function(x){t.push({key:"C",data:x})}),s=m,e=d);break}case"Z":t.push({key:"Z",data:[]}),s=i,e=h}r=n}return t}function Ct(l,t,r){return[l*Math.cos(r)-t*Math.sin(r),l*Math.sin(r)+t*Math.cos(r)]}function He(l,t,r,s,e,i,h,a,o,n){let c=(p=h,Math.PI*p/180);var p;let f=[],g=0,u=0,y=0,m=0;if(n)[g,u,y,m]=n;else{[l,t]=Ct(l,t,-c),[r,s]=Ct(r,s,-c);let E=(l-r)/2,B=(t-s)/2,I=E*E/(e*e)+B*B/(i*i);I>1&&(I=Math.sqrt(I),e*=I,i*=I);let R=e*e,q=i*i,z=R*q-R*B*B-q*E*E,T=R*B*B+q*E*E,F=(a===o?-1:1)*Math.sqrt(Math.abs(z/T));y=F*e*B/i+(l+r)/2,m=F*-i*E/e+(t+s)/2,g=Math.asin(parseFloat(((t-m)/i).toFixed(9))),u=Math.asin(parseFloat(((s-m)/i).toFixed(9))),l<y&&(g=Math.PI-g),r<y&&(u=Math.PI-u),g<0&&(g=2*Math.PI+g),u<0&&(u=2*Math.PI+u),o&&g>u&&(g-=2*Math.PI),!o&&u>g&&(u-=2*Math.PI)}let d=u-g;if(Math.abs(d)>120*Math.PI/180){let E=u,B=r,I=s;u=o&&u>g?g+120*Math.PI/180*1:g+120*Math.PI/180*-1,f=He(r=y+e*Math.cos(u),s=m+i*Math.sin(u),B,I,e,i,h,0,o,[u,E,y,m])}d=u-g;let x=Math.cos(g),w=Math.sin(g),b=Math.cos(u),v=Math.sin(u),S=Math.tan(d/4),D=4/3*e*S,$=4/3*i*S,P=[l,t],C=[l+D*w,t-$*x],O=[r+D*v,s-$*b],V=[r,s];if(C[0]=2*P[0]-C[0],C[1]=2*P[1]-C[1],n)return[C,O,V].concat(f);{f=[C,O,V].concat(f);let E=[];for(let B=0;B<f.length;B+=3){let I=Ct(f[B][0],f[B][1],c),R=Ct(f[B+1][0],f[B+1][1],c),q=Ct(f[B+2][0],f[B+2][1],c);E.push([I[0],I[1],R[0],R[1],q[0],q[1]])}return E}}var la={randOffset:function(l,t){return j(l,t)},randOffsetWithRange:function(l,t,r){return _t(l,t,r)},ellipse:function(l,t,r,s,e){let i=Ee(r,s,e);return ce(l,t,e,i).opset},doubleLineOps:function(l,t,r,s,e){return dt(l,t,r,s,e,!0)}};function Ie(l,t,r,s,e){return{type:"path",ops:dt(l,t,r,s,e)}}function Et(l,t,r){let s=(l||[]).length;if(s>2){let e=[];for(let i=0;i<s-1;i++)e.push(...dt(l[i][0],l[i][1],l[i+1][0],l[i+1][1],r));return t&&e.push(...dt(l[s-1][0],l[s-1][1],l[0][0],l[0][1],r)),{type:"path",ops:e}}return s===2?Ie(l[0][0],l[0][1],l[1][0],l[1][1],r):{type:"path",ops:[]}}function ca(l,t,r,s,e){return function(i,h){return Et(i,!0,h)}([[l,t],[l+r,t],[l+r,t+s],[l,t+s]],e)}function Pe(l,t){if(l.length){let r=typeof l[0][0]=="number"?[l]:l,s=Ht(r[0],1*(1+.2*t.roughness),t),e=t.disableMultiStroke?[]:Ht(r[0],1.5*(1+.22*t.roughness),Re(t));for(let i=1;i<r.length;i++){let h=r[i];if(h.length){let a=Ht(h,1*(1+.2*t.roughness),t),o=t.disableMultiStroke?[]:Ht(h,1.5*(1+.22*t.roughness),Re(t));for(let n of a)n.op!=="move"&&s.push(n);for(let n of o)n.op!=="move"&&e.push(n)}}return{type:"path",ops:s.concat(e)}}return{type:"path",ops:[]}}function Ee(l,t,r){let s=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(l/2,2)+Math.pow(t/2,2))/2)),e=Math.ceil(Math.max(r.curveStepCount,r.curveStepCount/Math.sqrt(200)*s)),i=2*Math.PI/e,h=Math.abs(l/2),a=Math.abs(t/2),o=1-r.curveFitting;return h+=j(h*o,r),a+=j(a*o,r),{increment:i,rx:h,ry:a}}function ce(l,t,r,s){let[e,i]=Le(s.increment,l,t,s.rx,s.ry,1,s.increment*_t(.1,_t(.4,1,r),r),r),h=zt(e,null,r);if(!r.disableMultiStroke&&r.roughness!==0){let[a]=Le(s.increment,l,t,s.rx,s.ry,1.5,0,r),o=zt(a,null,r);h=h.concat(o)}return{estimatedPoints:i,opset:{type:"path",ops:h}}}function Be(l,t,r,s,e,i,h,a,o){let n=l,c=t,p=Math.abs(r/2),f=Math.abs(s/2);p+=j(.01*p,o),f+=j(.01*f,o);let g=e,u=i;for(;g<0;)g+=2*Math.PI,u+=2*Math.PI;u-g>2*Math.PI&&(g=0,u=2*Math.PI);let y=2*Math.PI/o.curveStepCount,m=Math.min(y/2,(u-g)/2),d=Ne(m,n,c,p,f,g,u,1,o);if(!o.disableMultiStroke){let x=Ne(m,n,c,p,f,g,u,1.5,o);d.push(...x)}return h&&(a?d.push(...dt(n,c,n+p*Math.cos(g),c+f*Math.sin(g),o),...dt(n,c,n+p*Math.cos(u),c+f*Math.sin(u),o)):d.push({op:"lineTo",data:[n,c]},{op:"lineTo",data:[n+p*Math.cos(g),c+f*Math.sin(g)]})),{type:"path",ops:d}}function Ce(l,t){let r=We(Te(fe(l))),s=[],e=[0,0],i=[0,0];for(let{key:h,data:a}of r)switch(h){case"M":i=[a[0],a[1]],e=[a[0],a[1]];break;case"L":s.push(...dt(i[0],i[1],a[0],a[1],t)),i=[a[0],a[1]];break;case"C":{let[o,n,c,p,f,g]=a;s.push(...oa(o,n,c,p,f,g,i,t)),i=[f,g];break}case"Z":s.push(...dt(i[0],i[1],e[0],e[1],t)),i=[e[0],e[1]]}return{type:"path",ops:s}}function te(l,t){let r=[];for(let s of l)if(s.length){let e=t.maxRandomnessOffset||0,i=s.length;if(i>2){r.push({op:"move",data:[s[0][0]+j(e,t),s[0][1]+j(e,t)]});for(let h=1;h<i;h++)r.push({op:"lineTo",data:[s[h][0]+j(e,t),s[h][1]+j(e,t)]})}}return{type:"fillPath",ops:r}}function kt(l,t){return function(r,s){let e=r.fillStyle||"hachure";if(!it[e])switch(e){case"zigzag":it[e]||(it[e]=new se(s));break;case"cross-hatch":it[e]||(it[e]=new ae(s));break;case"dots":it[e]||(it[e]=new re(s));break;case"dashed":it[e]||(it[e]=new ie(s));break;case"zigzag-line":it[e]||(it[e]=new ne(s));break;default:e="hachure",it[e]||(it[e]=new Lt(s))}return it[e]}(t,la).fillPolygons(l,t)}function Re(l){let t=Object.assign({},l);return t.randomizer=void 0,l.seed&&(t.seed=l.seed+1),t}function Oe(l){return l.randomizer||(l.randomizer=new le(l.seed||0)),l.randomizer.next()}function _t(l,t,r,s=1){return r.roughness*s*(Oe(r)*(t-l)+l)}function j(l,t,r=1){return _t(-l,l,t,r)}function dt(l,t,r,s,e,i=!1){let h=i?e.disableMultiStrokeFill:e.disableMultiStroke,a=oe(l,t,r,s,e,!0,!1);if(h)return a;let o=oe(l,t,r,s,e,!0,!0);return a.concat(o)}function oe(l,t,r,s,e,i,h){let a=Math.pow(l-r,2)+Math.pow(t-s,2),o=Math.sqrt(a),n=1;n=o<200?1:o>500?.4:-.0016668*o+1.233334;let c=e.maxRandomnessOffset||0;c*c*100>a&&(c=o/10);let p=c/2,f=.2+.2*Oe(e),g=e.bowing*e.maxRandomnessOffset*(s-t)/200,u=e.bowing*e.maxRandomnessOffset*(l-r)/200;g=j(g,e,n),u=j(u,e,n);let y=[],m=()=>j(p,e,n),d=()=>j(c,e,n),x=e.preserveVertices;return i&&(h?y.push({op:"move",data:[l+(x?0:m()),t+(x?0:m())]}):y.push({op:"move",data:[l+(x?0:j(c,e,n)),t+(x?0:j(c,e,n))]})),h?y.push({op:"bcurveTo",data:[g+l+(r-l)*f+m(),u+t+(s-t)*f+m(),g+l+2*(r-l)*f+m(),u+t+2*(s-t)*f+m(),r+(x?0:m()),s+(x?0:m())]}):y.push({op:"bcurveTo",data:[g+l+(r-l)*f+d(),u+t+(s-t)*f+d(),g+l+2*(r-l)*f+d(),u+t+2*(s-t)*f+d(),r+(x?0:d()),s+(x?0:d())]}),y}function Ht(l,t,r){if(!l.length)return[];let s=[];s.push([l[0][0]+j(t,r),l[0][1]+j(t,r)]),s.push([l[0][0]+j(t,r),l[0][1]+j(t,r)]);for(let e=1;e<l.length;e++)s.push([l[e][0]+j(t,r),l[e][1]+j(t,r)]),e===l.length-1&&s.push([l[e][0]+j(t,r),l[e][1]+j(t,r)]);return zt(s,null,r)}function zt(l,t,r){let s=l.length,e=[];if(s>3){let i=[],h=1-r.curveTightness;e.push({op:"move",data:[l[1][0],l[1][1]]});for(let a=1;a+2<s;a++){let o=l[a];i[0]=[o[0],o[1]],i[1]=[o[0]+(h*l[a+1][0]-h*l[a-1][0])/6,o[1]+(h*l[a+1][1]-h*l[a-1][1])/6],i[2]=[l[a+1][0]+(h*l[a][0]-h*l[a+2][0])/6,l[a+1][1]+(h*l[a][1]-h*l[a+2][1])/6],i[3]=[l[a+1][0],l[a+1][1]],e.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[3][0],i[3][1]]})}if(t&&t.length===2){let a=r.maxRandomnessOffset;e.push({op:"lineTo",data:[t[0]+j(a,r),t[1]+j(a,r)]})}}else s===3?(e.push({op:"move",data:[l[1][0],l[1][1]]}),e.push({op:"bcurveTo",data:[l[1][0],l[1][1],l[2][0],l[2][1],l[2][0],l[2][1]]})):s===2&&e.push(...oe(l[0][0],l[0][1],l[1][0],l[1][1],r,!0,!0));return e}function Le(l,t,r,s,e,i,h,a){let o=[],n=[];if(a.roughness===0){l/=4,n.push([t+s*Math.cos(-l),r+e*Math.sin(-l)]);for(let c=0;c<=2*Math.PI;c+=l){let p=[t+s*Math.cos(c),r+e*Math.sin(c)];o.push(p),n.push(p)}n.push([t+s*Math.cos(0),r+e*Math.sin(0)]),n.push([t+s*Math.cos(l),r+e*Math.sin(l)])}else{let c=j(.5,a)-Math.PI/2;n.push([j(i,a)+t+.9*s*Math.cos(c-l),j(i,a)+r+.9*e*Math.sin(c-l)]);let p=2*Math.PI+c-.01;for(let f=c;f<p;f+=l){let g=[j(i,a)+t+s*Math.cos(f),j(i,a)+r+e*Math.sin(f)];o.push(g),n.push(g)}n.push([j(i,a)+t+s*Math.cos(c+2*Math.PI+.5*h),j(i,a)+r+e*Math.sin(c+2*Math.PI+.5*h)]),n.push([j(i,a)+t+.98*s*Math.cos(c+h),j(i,a)+r+.98*e*Math.sin(c+h)]),n.push([j(i,a)+t+.9*s*Math.cos(c+.5*h),j(i,a)+r+.9*e*Math.sin(c+.5*h)])}return[n,o]}function Ne(l,t,r,s,e,i,h,a,o){let n=i+j(.1,o),c=[];c.push([j(a,o)+t+.9*s*Math.cos(n-l),j(a,o)+r+.9*e*Math.sin(n-l)]);for(let p=n;p<=h;p+=l)c.push([j(a,o)+t+s*Math.cos(p),j(a,o)+r+e*Math.sin(p)]);return c.push([t+s*Math.cos(h),r+e*Math.sin(h)]),c.push([t+s*Math.cos(h),r+e*Math.sin(h)]),zt(c,null,o)}function oa(l,t,r,s,e,i,h,a){let o=[],n=[a.maxRandomnessOffset||1,(a.maxRandomnessOffset||1)+.3],c=[0,0],p=a.disableMultiStroke?1:2,f=a.preserveVertices;for(let g=0;g<p;g++)g===0?o.push({op:"move",data:[h[0],h[1]]}):o.push({op:"move",data:[h[0]+(f?0:j(n[0],a)),h[1]+(f?0:j(n[0],a))]}),c=f?[e,i]:[e+j(n[g],a),i+j(n[g],a)],o.push({op:"bcurveTo",data:[l+j(n[g],a),t+j(n[g],a),r+j(n[g],a),s+j(n[g],a),c[0],c[1]]});return o}function Rt(l){return[...l]}function Ae(l,t=0){let r=l.length;if(r<3)throw new Error("A curve must have at least three points.");let s=[];if(r===3)s.push(Rt(l[0]),Rt(l[1]),Rt(l[2]),Rt(l[2]));else{let e=[];e.push(l[0],l[0]);for(let a=1;a<l.length;a++)e.push(l[a]),a===l.length-1&&e.push(l[a]);let i=[],h=1-t;s.push(Rt(e[0]));for(let a=1;a+2<e.length;a++){let o=e[a];i[0]=[o[0],o[1]],i[1]=[o[0]+(h*e[a+1][0]-h*e[a-1][0])/6,o[1]+(h*e[a+1][1]-h*e[a-1][1])/6],i[2]=[e[a+1][0]+(h*e[a][0]-h*e[a+2][0])/6,e[a+1][1]+(h*e[a][1]-h*e[a+2][1])/6],i[3]=[e[a+1][0],e[a+1][1]],s.push(i[1],i[2],i[3])}}return s}function Ot(l,t){return Math.pow(l[0]-t[0],2)+Math.pow(l[1]-t[1],2)}function ha(l,t,r){let s=Ot(t,r);if(s===0)return Ot(l,t);let e=((l[0]-t[0])*(r[0]-t[0])+(l[1]-t[1])*(r[1]-t[1]))/s;return e=Math.max(0,Math.min(1,e)),Ot(l,bt(t,r,e))}function bt(l,t,r){return[l[0]+(t[0]-l[0])*r,l[1]+(t[1]-l[1])*r]}function he(l,t,r,s){let e=s||[];if(function(a,o){let n=a[o+0],c=a[o+1],p=a[o+2],f=a[o+3],g=3*c[0]-2*n[0]-f[0];g*=g;let u=3*c[1]-2*n[1]-f[1];u*=u;let y=3*p[0]-2*f[0]-n[0];y*=y;let m=3*p[1]-2*f[1]-n[1];return m*=m,g<y&&(g=y),u<m&&(u=m),g+u}(l,t)<r){let a=l[t+0];e.length?(i=e[e.length-1],h=a,Math.sqrt(Ot(i,h))>1&&e.push(a)):e.push(a),e.push(l[t+3])}else{let o=l[t+0],n=l[t+1],c=l[t+2],p=l[t+3],f=bt(o,n,.5),g=bt(n,c,.5),u=bt(c,p,.5),y=bt(f,g,.5),m=bt(g,u,.5),d=bt(y,m,.5);he([o,f,y,d],0,r,e),he([d,m,u,p],0,r,e)}var i,h;return e}function ga(l,t){return jt(l,0,l.length,t)}function jt(l,t,r,s,e){let i=e||[],h=l[t],a=l[r-1],o=0,n=1;for(let c=t+1;c<r-1;++c){let p=ha(l[c],h,a);p>o&&(o=p,n=c)}return Math.sqrt(o)>s?(jt(l,t,n+1,s,i),jt(l,n,r,s,i)):(i.length||i.push(h),i.push(a)),i}function ee(l,t=.15,r){let s=[],e=(l.length-1)/3;for(let i=0;i<e;i++)he(l,3*i,t,s);return r&&r>0?jt(s,0,s.length,r):s}var ct="none",Mt=class{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,r,s){return{shape:t,sets:r||[],options:s||this.defaultOptions}}line(t,r,s,e,i){let h=this._o(i);return this._d("line",[Ie(t,r,s,e,h)],h)}rectangle(t,r,s,e,i){let h=this._o(i),a=[],o=ca(t,r,s,e,h);if(h.fill){let n=[[t,r],[t+s,r],[t+s,r+e],[t,r+e]];h.fillStyle==="solid"?a.push(te([n],h)):a.push(kt([n],h))}return h.stroke!==ct&&a.push(o),this._d("rectangle",a,h)}ellipse(t,r,s,e,i){let h=this._o(i),a=[],o=Ee(s,e,h),n=ce(t,r,h,o);if(h.fill)if(h.fillStyle==="solid"){let c=ce(t,r,h,o).opset;c.type="fillPath",a.push(c)}else a.push(kt([n.estimatedPoints],h));return h.stroke!==ct&&a.push(n.opset),this._d("ellipse",a,h)}circle(t,r,s,e){let i=this.ellipse(t,r,s,s,e);return i.shape="circle",i}linearPath(t,r){let s=this._o(r);return this._d("linearPath",[Et(t,!1,s)],s)}arc(t,r,s,e,i,h,a=!1,o){let n=this._o(o),c=[],p=Be(t,r,s,e,i,h,a,!0,n);if(a&&n.fill)if(n.fillStyle==="solid"){let f=Object.assign({},n);f.disableMultiStroke=!0;let g=Be(t,r,s,e,i,h,!0,!1,f);g.type="fillPath",c.push(g)}else c.push(function(f,g,u,y,m,d,x){let w=f,b=g,v=Math.abs(u/2),S=Math.abs(y/2);v+=j(.01*v,x),S+=j(.01*S,x);let D=m,$=d;for(;D<0;)D+=2*Math.PI,$+=2*Math.PI;$-D>2*Math.PI&&(D=0,$=2*Math.PI);let P=($-D)/x.curveStepCount,C=[];for(let O=D;O<=$;O+=P)C.push([w+v*Math.cos(O),b+S*Math.sin(O)]);return C.push([w+v*Math.cos($),b+S*Math.sin($)]),C.push([w,b]),kt([C],x)}(t,r,s,e,i,h,n));return n.stroke!==ct&&c.push(p),this._d("arc",c,n)}curve(t,r){let s=this._o(r),e=[],i=Pe(t,s);if(s.fill&&s.fill!==ct)if(s.fillStyle==="solid"){let h=Pe(t,Object.assign(Object.assign({},s),{disableMultiStroke:!0,roughness:s.roughness?s.roughness+s.fillShapeRoughnessGain:0}));e.push({type:"fillPath",ops:this._mergedShape(h.ops)})}else{let h=[],a=t;if(a.length){let o=typeof a[0][0]=="number"?[a]:a;for(let n of o)n.length<3?h.push(...n):n.length===3?h.push(...ee(Ae([n[0],n[0],n[1],n[2]]),10,(1+s.roughness)/2)):h.push(...ee(Ae(n),10,(1+s.roughness)/2))}h.length&&e.push(kt([h],s))}return s.stroke!==ct&&e.push(i),this._d("curve",e,s)}polygon(t,r){let s=this._o(r),e=[],i=Et(t,!0,s);return s.fill&&(s.fillStyle==="solid"?e.push(te([t],s)):e.push(kt([t],s))),s.stroke!==ct&&e.push(i),this._d("polygon",e,s)}path(t,r){let s=this._o(r),e=[];if(!t)return this._d("path",e,s);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");let i=s.fill&&s.fill!=="transparent"&&s.fill!==ct,h=s.stroke!==ct,a=!!(s.simplification&&s.simplification<1),o=function(c,p,f){let g=We(Te(fe(c))),u=[],y=[],m=[0,0],d=[],x=()=>{d.length>=4&&y.push(...ee(d,p)),d=[]},w=()=>{x(),y.length&&(u.push(y),y=[])};for(let{key:v,data:S}of g)switch(v){case"M":w(),m=[S[0],S[1]],y.push(m);break;case"L":x(),y.push([S[0],S[1]]);break;case"C":if(!d.length){let D=y.length?y[y.length-1]:m;d.push([D[0],D[1]])}d.push([S[0],S[1]]),d.push([S[2],S[3]]),d.push([S[4],S[5]]);break;case"Z":x(),y.push([m[0],m[1]])}if(w(),!f)return u;let b=[];for(let v of u){let S=ga(v,f);S.length&&b.push(S)}return b}(t,1,a?4-4*(s.simplification||1):(1+s.roughness)/2),n=Ce(t,s);if(i)if(s.fillStyle==="solid")if(o.length===1){let c=Ce(t,Object.assign(Object.assign({},s),{disableMultiStroke:!0,roughness:s.roughness?s.roughness+s.fillShapeRoughnessGain:0}));e.push({type:"fillPath",ops:this._mergedShape(c.ops)})}else e.push(te(o,s));else e.push(kt(o,s));return h&&(a?o.forEach(c=>{e.push(Et(c,!1,s))}):e.push(n)),this._d("path",e,s)}opsToPath(t,r){let s="";for(let e of t.ops){let i=typeof r=="number"&&r>=0?e.data.map(h=>+h.toFixed(r)):e.data;switch(e.op){case"move":s+=`M${i[0]} ${i[1]} `;break;case"bcurveTo":s+=`C${i[0]} ${i[1]}, ${i[2]} ${i[3]}, ${i[4]} ${i[5]} `;break;case"lineTo":s+=`L${i[0]} ${i[1]} `}}return s.trim()}toPaths(t){let r=t.sets||[],s=t.options||this.defaultOptions,e=[];for(let i of r){let h=null;switch(i.type){case"path":h={d:this.opsToPath(i),stroke:s.stroke,strokeWidth:s.strokeWidth,fill:ct};break;case"fillPath":h={d:this.opsToPath(i),stroke:ct,strokeWidth:0,fill:s.fill||ct};break;case"fillSketch":h=this.fillSketch(i,s)}h&&e.push(h)}return e}fillSketch(t,r){let s=r.fillWeight;return s<0&&(s=r.strokeWidth/2),{d:this.opsToPath(t),stroke:r.fill||ct,strokeWidth:s,fill:ct}}_mergedShape(t){return t.filter((r,s)=>s===0||r.op!=="move")}},ge=class{constructor(t,r){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new Mt(r)}draw(t){let r=t.sets||[],s=t.options||this.getDefaultOptions(),e=this.ctx,i=t.options.fixedDecimalPlaceDigits;for(let h of r)switch(h.type){case"path":e.save(),e.strokeStyle=s.stroke==="none"?"transparent":s.stroke,e.lineWidth=s.strokeWidth,s.strokeLineDash&&e.setLineDash(s.strokeLineDash),s.strokeLineDashOffset&&(e.lineDashOffset=s.strokeLineDashOffset),this._drawToContext(e,h,i),e.restore();break;case"fillPath":{e.save(),e.fillStyle=s.fill||"";let a=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(e,h,i,a),e.restore();break}case"fillSketch":this.fillSketch(e,h,s)}}fillSketch(t,r,s){let e=s.fillWeight;e<0&&(e=s.strokeWidth/2),t.save(),s.fillLineDash&&t.setLineDash(s.fillLineDash),s.fillLineDashOffset&&(t.lineDashOffset=s.fillLineDashOffset),t.strokeStyle=s.fill||"",t.lineWidth=e,this._drawToContext(t,r,s.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,r,s,e="nonzero"){t.beginPath();for(let i of r.ops){let h=typeof s=="number"&&s>=0?i.data.map(a=>+a.toFixed(s)):i.data;switch(i.op){case"move":t.moveTo(h[0],h[1]);break;case"bcurveTo":t.bezierCurveTo(h[0],h[1],h[2],h[3],h[4],h[5]);break;case"lineTo":t.lineTo(h[0],h[1])}}r.type==="fillPath"?t.fill(e):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,r,s,e,i){let h=this.gen.line(t,r,s,e,i);return this.draw(h),h}rectangle(t,r,s,e,i){let h=this.gen.rectangle(t,r,s,e,i);return this.draw(h),h}ellipse(t,r,s,e,i){let h=this.gen.ellipse(t,r,s,e,i);return this.draw(h),h}circle(t,r,s,e){let i=this.gen.circle(t,r,s,e);return this.draw(i),i}linearPath(t,r){let s=this.gen.linearPath(t,r);return this.draw(s),s}polygon(t,r){let s=this.gen.polygon(t,r);return this.draw(s),s}arc(t,r,s,e,i,h,a=!1,o){let n=this.gen.arc(t,r,s,e,i,h,a,o);return this.draw(n),n}curve(t,r){let s=this.gen.curve(t,r);return this.draw(s),s}path(t,r){let s=this.gen.path(t,r);return this.draw(s),s}},It="http://www.w3.org/2000/svg",pe=class{constructor(t,r){this.svg=t,this.gen=new Mt(r)}draw(t){let r=t.sets||[],s=t.options||this.getDefaultOptions(),e=this.svg.ownerDocument||window.document,i=e.createElementNS(It,"g"),h=t.options.fixedDecimalPlaceDigits;for(let a of r){let o=null;switch(a.type){case"path":o=e.createElementNS(It,"path"),o.setAttribute("d",this.opsToPath(a,h)),o.setAttribute("stroke",s.stroke),o.setAttribute("stroke-width",s.strokeWidth+""),o.setAttribute("fill","none"),s.strokeLineDash&&o.setAttribute("stroke-dasharray",s.strokeLineDash.join(" ").trim()),s.strokeLineDashOffset&&o.setAttribute("stroke-dashoffset",`${s.strokeLineDashOffset}`);break;case"fillPath":o=e.createElementNS(It,"path"),o.setAttribute("d",this.opsToPath(a,h)),o.setAttribute("stroke","none"),o.setAttribute("stroke-width","0"),o.setAttribute("fill",s.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||o.setAttribute("fill-rule","evenodd");break;case"fillSketch":o=this.fillSketch(e,a,s)}o&&i.appendChild(o)}return i}fillSketch(t,r,s){let e=s.fillWeight;e<0&&(e=s.strokeWidth/2);let i=t.createElementNS(It,"path");return i.setAttribute("d",this.opsToPath(r,s.fixedDecimalPlaceDigits)),i.setAttribute("stroke",s.fill||""),i.setAttribute("stroke-width",e+""),i.setAttribute("fill","none"),s.fillLineDash&&i.setAttribute("stroke-dasharray",s.fillLineDash.join(" ").trim()),s.fillLineDashOffset&&i.setAttribute("stroke-dashoffset",`${s.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,r){return this.gen.opsToPath(t,r)}line(t,r,s,e,i){let h=this.gen.line(t,r,s,e,i);return this.draw(h)}rectangle(t,r,s,e,i){let h=this.gen.rectangle(t,r,s,e,i);return this.draw(h)}ellipse(t,r,s,e,i){let h=this.gen.ellipse(t,r,s,e,i);return this.draw(h)}circle(t,r,s,e){let i=this.gen.circle(t,r,s,e);return this.draw(i)}linearPath(t,r){let s=this.gen.linearPath(t,r);return this.draw(s)}polygon(t,r){let s=this.gen.polygon(t,r);return this.draw(s)}arc(t,r,s,e,i,h,a=!1,o){let n=this.gen.arc(t,r,s,e,i,h,a,o);return this.draw(n)}curve(t,r){let s=this.gen.curve(t,r);return this.draw(s)}path(t,r){let s=this.gen.path(t,r);return this.draw(s)}},M={canvas:(l,t)=>new ge(l,t),svg:(l,t)=>new pe(l,t),generator:l=>new Mt(l),newSeed:()=>Mt.newSeed()};var X=k((l,t,r)=>L(null,null,function*(){let s,e=t.useHtmlLabels||tt(U()?.htmlLabels);r?s=r:s="node default";let i=l.insert("g").attr("class",s).attr("id",t.domId||t.id),h=i.insert("g").attr("class","label").attr("style",at(t.labelStyle)),a;t.label===void 0?a="":a=typeof t.label=="string"?t.label:t.label[0];let o=yield yt(h,Xt(St(a),U()),{useHtmlLabels:e,width:t.width||U().flowchart?.wrappingWidth,cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img}),n=o.getBBox(),c=(t?.padding??0)/2;if(e){let p=o.children[0],f=K(o),g=p.getElementsByTagName("img");if(g){let u=a.replace(/<img[^>]*>/g,"").trim()==="";yield Promise.all([...g].map(y=>new Promise(m=>{function d(){if(y.style.display="flex",y.style.flexDirection="column",u){let x=U().fontSize?U().fontSize:window.getComputedStyle(document.body).fontSize,w=5,[b=Se.fontSize]=$e(x),v=b*w+"px";y.style.minWidth=v,y.style.maxWidth=v}else y.style.width="100%";m(y)}k(d,"setupImage"),setTimeout(()=>{y.complete&&d()}),y.addEventListener("error",d),y.addEventListener("load",d)})))}n=p.getBoundingClientRect(),f.attr("width",n.width),f.attr("height",n.height)}return e?h.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"):h.attr("transform","translate(0, "+-n.height/2+")"),t.centerLabel&&h.attr("transform","translate("+-n.width/2+", "+-n.height/2+")"),h.insert("rect",":first-child"),{shapeSvg:i,bbox:n,halfPadding:c,label:h}}),"labelHelper"),ue=k((l,t,r)=>L(null,null,function*(){let s=r.useHtmlLabels||tt(U()?.flowchart?.htmlLabels),e=l.insert("g").attr("class","label").attr("style",r.labelStyle||""),i=yield yt(e,Xt(St(t),U()),{useHtmlLabels:s,width:r.width||U()?.flowchart?.wrappingWidth,style:r.labelStyle,addSvgBackground:!!r.icon||!!r.img}),h=i.getBBox(),a=r.padding/2;if(tt(U()?.flowchart?.htmlLabels)){let o=i.children[0],n=K(i);h=o.getBoundingClientRect(),n.attr("width",h.width),n.attr("height",h.height)}return s?e.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"):e.attr("transform","translate(0, "+-h.height/2+")"),r.centerLabel&&e.attr("transform","translate("+-h.width/2+", "+-h.height/2+")"),e.insert("rect",":first-child"),{shapeSvg:l,bbox:h,halfPadding:a,label:e}}),"insertLabel"),H=k((l,t)=>{let r=t.node().getBBox();l.width=r.width,l.height=r.height},"updateNodeBounds"),G=k((l,t)=>(l.look==="handDrawn"?"rough-node":"node")+" "+l.cssClasses+" "+(t||""),"getNodeClasses");function Z(l){let t=l.map((r,s)=>`${s===0?"M":"L"}${r.x},${r.y}`);return t.push("Z"),t.join(" ")}k(Z,"createPathFromPoints");function mt(l,t,r,s,e,i){let h=[],o=r-l,n=s-t,c=o/i,p=2*Math.PI/c,f=t+n/2;for(let g=0;g<=50;g++){let u=g/50,y=l+u*o,m=f+e*Math.sin(p*(y-l));h.push({x:y,y:m})}return h}k(mt,"generateFullSineWavePoints");function xe(l,t,r,s,e,i){let h=[],a=e*Math.PI/180,c=(i*Math.PI/180-a)/(s-1);for(let p=0;p<s;p++){let f=a+p*c,g=l+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:-g,y:-u})}return h}k(xe,"generateCirclePoints");var pa=k((l,t)=>{var r=l.x,s=l.y,e=t.x-r,i=t.y-s,h=l.width/2,a=l.height/2,o,n;return Math.abs(i)*h>Math.abs(e)*a?(i<0&&(a=-a),o=i===0?0:a*e/i,n=a):(e<0&&(h=-h),o=h,n=e===0?0:h*i/e),{x:r+o,y:s+n}},"intersectRect"),$t=pa;function _e(l,t){t&&l.attr("style",t)}k(_e,"applyStyle");function ze(l){return L(this,null,function*(){let t=K(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),r=t.append("xhtml:div"),s=l.label;l.label&&Vt(l.label)&&(s=yield ke(l.label.replace(Me.lineBreakRegex,`
`),U()));let e=l.isNode?"nodeLabel":"edgeLabel";return r.html('<span class="'+e+'" '+(l.labelStyle?'style="'+l.labelStyle+'"':"")+">"+s+"</span>"),_e(r,l.labelStyle),r.style("display","inline-block"),r.style("padding-right","1px"),r.style("white-space","nowrap"),r.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()})}k(ze,"addHtmlLabel");var fa=k((l,t,r,s)=>L(null,null,function*(){let e=l||"";if(typeof e=="object"&&(e=e[0]),tt(U().flowchart.htmlLabels)){e=e.replace(/\\n|\n/g,"<br />"),Q.info("vertexText"+e);let i={isNode:s,label:St(e).replace(/fa[blrs]?:fa-[\w-]+/g,a=>`<i class='${a.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return yield ze(i)}else{let i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("style",t.replace("color:","fill:"));let h=[];typeof e=="string"?h=e.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(e)?h=e:h=[];for(let a of h){let o=document.createElementNS("http://www.w3.org/2000/svg","tspan");o.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),o.setAttribute("dy","1em"),o.setAttribute("x","0"),r?o.setAttribute("class","title-row"):o.setAttribute("class","row"),o.textContent=a.trim(),i.appendChild(o)}return i}}),"createLabel"),ye=fa,pt=k((l,t,r,s,e)=>["M",l+e,t,"H",l+r-e,"A",e,e,0,0,1,l+r,t+e,"V",t+s-e,"A",e,e,0,0,1,l+r-e,t+s,"H",l+e,"A",e,e,0,0,1,l,t+s-e,"V",t+e,"A",e,e,0,0,1,l+e,t,"Z"].join(" "),"createRoundedRectPathD"),je=k((l,t)=>L(null,null,function*(){Q.info("Creating subgraph rect for ",t.id,t);let r=U(),{themeVariables:s,handDrawnSeed:e}=r,{clusterBkg:i,clusterBorder:h}=s,{labelStyles:a,nodeStyles:o,borderStyles:n,backgroundStyles:c}=W(t),p=l.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),f=tt(r.flowchart.htmlLabels),g=p.insert("g").attr("class","cluster-label "),u=yield yt(g,t.label,{style:t.labelStyle,useHtmlLabels:f,isNode:!0}),y=u.getBBox();if(tt(r.flowchart.htmlLabels)){let D=u.children[0],$=K(u);y=D.getBoundingClientRect(),$.attr("width",y.width),$.attr("height",y.height)}let m=t.width<=y.width+t.padding?y.width+t.padding:t.width;t.width<=y.width+t.padding?t.diff=(m-t.width)/2-t.padding:t.diff=-t.padding;let d=t.height,x=t.x-m/2,w=t.y-d/2;Q.trace("Data ",t,JSON.stringify(t));let b;if(t.look==="handDrawn"){let D=M.svg(p),$=A(t,{roughness:.7,fill:i,stroke:h,fillWeight:3,seed:e}),P=D.path(pt(x,w,m,d,0),$);b=p.insert(()=>(Q.debug("Rough node insert CXC",P),P),":first-child"),b.select("path:nth-child(2)").attr("style",n.join(";")),b.select("path").attr("style",c.join(";").replace("fill","stroke"))}else b=p.insert("rect",":first-child"),b.attr("style",o).attr("rx",t.rx).attr("ry",t.ry).attr("x",x).attr("y",w).attr("width",m).attr("height",d);let{subGraphTitleTopMargin:v}=Qt(r);if(g.attr("transform",`translate(${t.x-y.width/2}, ${t.y-t.height/2+v})`),a){let D=g.select("span");D&&D.attr("style",a)}let S=b.node().getBBox();return t.offsetX=0,t.width=S.width,t.height=S.height,t.offsetY=y.height-t.padding/2,t.intersect=function(D){return $t(t,D)},{cluster:p,labelBBox:y}}),"rect"),ua=k((l,t)=>{let r=l.insert("g").attr("class","note-cluster").attr("id",t.id),s=r.insert("rect",":first-child"),e=0*t.padding,i=e/2;s.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-i).attr("y",t.y-t.height/2-i).attr("width",t.width+e).attr("height",t.height+e).attr("fill","none");let h=s.node().getBBox();return t.width=h.width,t.height=h.height,t.intersect=function(a){return $t(t,a)},{cluster:r,labelBBox:{width:0,height:0}}},"noteGroup"),ya=k((l,t)=>L(null,null,function*(){let r=U(),{themeVariables:s,handDrawnSeed:e}=r,{altBackground:i,compositeBackground:h,compositeTitleBackground:a,nodeBorder:o}=s,n=l.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),c=n.insert("g",":first-child"),p=n.insert("g").attr("class","cluster-label"),f=n.append("rect"),g=p.node().appendChild(yield ye(t.label,t.labelStyle,void 0,!0)),u=g.getBBox();if(tt(r.flowchart.htmlLabels)){let P=g.children[0],C=K(g);u=P.getBoundingClientRect(),C.attr("width",u.width),C.attr("height",u.height)}let y=0*t.padding,m=y/2,d=(t.width<=u.width+t.padding?u.width+t.padding:t.width)+y;t.width<=u.width+t.padding?t.diff=(d-t.width)/2-t.padding:t.diff=-t.padding;let x=t.height+y,w=t.height+y-u.height-6,b=t.x-d/2,v=t.y-x/2;t.width=d;let S=t.y-t.height/2-m+u.height+2,D;if(t.look==="handDrawn"){let P=t.cssClasses.includes("statediagram-cluster-alt"),C=M.svg(n),O=t.rx||t.ry?C.path(pt(b,v,d,x,10),{roughness:.7,fill:a,fillStyle:"solid",stroke:o,seed:e}):C.rectangle(b,v,d,x,{seed:e});D=n.insert(()=>O,":first-child");let V=C.rectangle(b,S,d,w,{fill:P?i:h,fillStyle:P?"hachure":"solid",stroke:o,seed:e});D=n.insert(()=>O,":first-child"),f=n.insert(()=>V)}else D=c.insert("rect",":first-child"),D.attr("class","outer").attr("x",b).attr("y",v).attr("width",d).attr("height",x).attr("data-look",t.look),f.attr("class","inner").attr("x",b).attr("y",S).attr("width",d).attr("height",w);p.attr("transform",`translate(${t.x-u.width/2}, ${v+1-(tt(r.flowchart.htmlLabels)?0:3)})`);let $=D.node().getBBox();return t.height=$.height,t.offsetX=0,t.offsetY=u.height-t.padding/2,t.labelBBox=u,t.intersect=function(P){return $t(t,P)},{cluster:n,labelBBox:u}}),"roundedWithTitle"),da=k((l,t)=>L(null,null,function*(){Q.info("Creating subgraph rect for ",t.id,t);let r=U(),{themeVariables:s,handDrawnSeed:e}=r,{clusterBkg:i,clusterBorder:h}=s,{labelStyles:a,nodeStyles:o,borderStyles:n,backgroundStyles:c}=W(t),p=l.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),f=tt(r.flowchart.htmlLabels),g=p.insert("g").attr("class","cluster-label "),u=yield yt(g,t.label,{style:t.labelStyle,useHtmlLabels:f,isNode:!0,width:t.width}),y=u.getBBox();if(tt(r.flowchart.htmlLabels)){let D=u.children[0],$=K(u);y=D.getBoundingClientRect(),$.attr("width",y.width),$.attr("height",y.height)}let m=t.width<=y.width+t.padding?y.width+t.padding:t.width;t.width<=y.width+t.padding?t.diff=(m-t.width)/2-t.padding:t.diff=-t.padding;let d=t.height,x=t.x-m/2,w=t.y-d/2;Q.trace("Data ",t,JSON.stringify(t));let b;if(t.look==="handDrawn"){let D=M.svg(p),$=A(t,{roughness:.7,fill:i,stroke:h,fillWeight:4,seed:e}),P=D.path(pt(x,w,m,d,t.rx),$);b=p.insert(()=>(Q.debug("Rough node insert CXC",P),P),":first-child"),b.select("path:nth-child(2)").attr("style",n.join(";")),b.select("path").attr("style",c.join(";").replace("fill","stroke"))}else b=p.insert("rect",":first-child"),b.attr("style",o).attr("rx",t.rx).attr("ry",t.ry).attr("x",x).attr("y",w).attr("width",m).attr("height",d);let{subGraphTitleTopMargin:v}=Qt(r);if(g.attr("transform",`translate(${t.x-y.width/2}, ${t.y-t.height/2+v})`),a){let D=g.select("span");D&&D.attr("style",a)}let S=b.node().getBBox();return t.offsetX=0,t.width=S.width,t.height=S.height,t.offsetY=y.height-t.padding/2,t.intersect=function(D){return $t(t,D)},{cluster:p,labelBBox:y}}),"kanbanSection"),ma=k((l,t)=>{let r=U(),{themeVariables:s,handDrawnSeed:e}=r,{nodeBorder:i}=s,h=l.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),a=h.insert("g",":first-child"),o=0*t.padding,n=t.width+o;t.diff=-t.padding;let c=t.height+o,p=t.x-n/2,f=t.y-c/2;t.width=n;let g;if(t.look==="handDrawn"){let m=M.svg(h).rectangle(p,f,n,c,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:i,seed:e});g=h.insert(()=>m,":first-child")}else g=a.insert("rect",":first-child"),g.attr("class","divider").attr("x",p).attr("y",f).attr("width",n).attr("height",c).attr("data-look",t.look);let u=g.node().getBBox();return t.height=u.height,t.offsetX=0,t.offsetY=0,t.intersect=function(y){return $t(t,y)},{cluster:h,labelBBox:{}}},"divider"),xa=je,ba={rect:je,squareRect:xa,roundedWithTitle:ya,noteGroup:ua,divider:ma,kanbanSection:da},Ge=new Map,Ja=k((l,t)=>L(null,null,function*(){let r=t.shape||"rect",s=yield ba[r](l,t);return Ge.set(t.id,s),s}),"insertCluster"),Ka=k(()=>{Ge=new Map},"clear");function Fe(l,t){return l.intersect(t)}k(Fe,"intersectNode");var wa=Fe;function qe(l,t,r,s){var e=l.x,i=l.y,h=e-s.x,a=i-s.y,o=Math.sqrt(t*t*a*a+r*r*h*h),n=Math.abs(t*r*h/o);s.x<e&&(n=-n);var c=Math.abs(t*r*a/o);return s.y<i&&(c=-c),{x:e+n,y:i+c}}k(qe,"intersectEllipse");var Xe=qe;function Ye(l,t,r){return Xe(l,t,t,r)}k(Ye,"intersectCircle");var Sa=Ye;function Ve(l,t,r,s){var e,i,h,a,o,n,c,p,f,g,u,y,m,d,x;if(e=t.y-l.y,h=l.x-t.x,o=t.x*l.y-l.x*t.y,f=e*r.x+h*r.y+o,g=e*s.x+h*s.y+o,!(f!==0&&g!==0&&de(f,g))&&(i=s.y-r.y,a=r.x-s.x,n=s.x*r.y-r.x*s.y,c=i*l.x+a*l.y+n,p=i*t.x+a*t.y+n,!(c!==0&&p!==0&&de(c,p))&&(u=e*a-i*h,u!==0)))return y=Math.abs(u/2),m=h*n-a*o,d=m<0?(m-y)/u:(m+y)/u,m=i*o-e*n,x=m<0?(m-y)/u:(m+y)/u,{x:d,y:x}}k(Ve,"intersectLine");function de(l,t){return l*t>0}k(de,"sameSign");var ka=Ve;function Ze(l,t,r){let s=l.x,e=l.y,i=[],h=Number.POSITIVE_INFINITY,a=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(c){h=Math.min(h,c.x),a=Math.min(a,c.y)}):(h=Math.min(h,t.x),a=Math.min(a,t.y));let o=s-l.width/2-h,n=e-l.height/2-a;for(let c=0;c<t.length;c++){let p=t[c],f=t[c<t.length-1?c+1:0],g=ka(l,r,{x:o+p.x,y:n+p.y},{x:o+f.x,y:n+f.y});g&&i.push(g)}return i.length?(i.length>1&&i.sort(function(c,p){let f=c.x-r.x,g=c.y-r.y,u=Math.sqrt(f*f+g*g),y=p.x-r.x,m=p.y-r.y,d=Math.sqrt(y*y+m*m);return u<d?-1:u===d?0:1}),i[0]):l}k(Ze,"intersectPolygon");var Ma=Ze,N={node:wa,circle:Sa,ellipse:Xe,polygon:Ma,rect:$t};function Qe(l,t){let{labelStyles:r}=W(t);t.labelStyle=r;let s=G(t),e=s;s||(e="anchor");let i=l.insert("g").attr("class",e).attr("id",t.domId||t.id),h=1,{cssStyles:a}=t,o=M.svg(i),n=A(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(n.roughness=0);let c=o.circle(0,0,h*2,n),p=i.insert(()=>c,":first-child");return p.attr("class","anchor").attr("style",at(a)),H(t,p),t.intersect=function(f){return Q.info("Circle intersect",t,h,f),N.circle(t,h,f)},i}k(Qe,"anchor");function me(l,t,r,s,e,i,h){let o=(l+r)/2,n=(t+s)/2,c=Math.atan2(s-t,r-l),p=(r-l)/2,f=(s-t)/2,g=p/e,u=f/i,y=Math.sqrt(g**2+u**2);if(y>1)throw new Error("The given radii are too small to create an arc between the points.");let m=Math.sqrt(1-y**2),d=o+m*i*Math.sin(c)*(h?-1:1),x=n-m*e*Math.cos(c)*(h?-1:1),w=Math.atan2((t-x)/i,(l-d)/e),v=Math.atan2((s-x)/i,(r-d)/e)-w;h&&v<0&&(v+=2*Math.PI),!h&&v>0&&(v-=2*Math.PI);let S=[];for(let D=0;D<20;D++){let $=D/19,P=w+$*v,C=d+e*Math.cos(P),O=x+i*Math.sin(P);S.push({x:C,y:O})}return S}k(me,"generateArcPoints");function Je(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=i.width+t.padding+20,a=i.height+t.padding,o=a/2,n=o/(2.5+a/50),{cssStyles:c}=t,p=[{x:h/2,y:-a/2},{x:-h/2,y:-a/2},...me(-h/2,-a/2,-h/2,a/2,n,o,!1),{x:h/2,y:a/2},...me(h/2,a/2,h/2,-a/2,n,o,!0)],f=M.svg(e),g=A(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let u=Z(p),y=f.path(u,g),m=e.insert(()=>y,":first-child");return m.attr("class","basic label-container"),c&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",c),s&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",s),m.attr("transform",`translate(${n/2}, 0)`),H(t,m),t.intersect=function(d){return N.polygon(t,p,d)},e})}k(Je,"bowTieRect");function ft(l,t,r,s){return l.insert("polygon",":first-child").attr("points",s.map(function(e){return e.x+","+e.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+r/2+")")}k(ft,"insertPolygonShape");function Ke(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=i.height+t.padding,a=12,o=i.width+t.padding+a,n=0,c=o,p=-h,f=0,g=[{x:n+a,y:p},{x:c,y:p},{x:c,y:f},{x:n,y:f},{x:n,y:p+a},{x:n+a,y:p}],u,{cssStyles:y}=t;if(t.look==="handDrawn"){let m=M.svg(e),d=A(t,{}),x=Z(g),w=m.path(x,d);u=e.insert(()=>w,":first-child").attr("transform",`translate(${-o/2}, ${h/2})`),y&&u.attr("style",y)}else u=ft(e,o,h,g);return s&&u.attr("style",s),H(t,u),t.intersect=function(m){return N.polygon(t,g,m)},e})}k(Ke,"card");function Ue(l,t){let{nodeStyles:r}=W(t);t.label="";let s=l.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),{cssStyles:e}=t,i=Math.max(28,t.width??0),h=[{x:0,y:i/2},{x:i/2,y:0},{x:0,y:-i/2},{x:-i/2,y:0}],a=M.svg(s),o=A(t,{});t.look!=="handDrawn"&&(o.roughness=0,o.fillStyle="solid");let n=Z(h),c=a.path(n,o),p=s.insert(()=>c,":first-child");return e&&t.look!=="handDrawn"&&p.selectAll("path").attr("style",e),r&&t.look!=="handDrawn"&&p.selectAll("path").attr("style",r),t.width=28,t.height=28,t.intersect=function(f){return N.polygon(t,h,f)},s}k(Ue,"choice");function ts(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,halfPadding:h}=yield X(l,t,G(t)),a=i.width/2+h,o,{cssStyles:n}=t;if(t.look==="handDrawn"){let c=M.svg(e),p=A(t,{}),f=c.circle(0,0,a*2,p);o=e.insert(()=>f,":first-child"),o.attr("class","basic label-container").attr("style",at(n))}else o=e.insert("circle",":first-child").attr("class","basic label-container").attr("style",s).attr("r",a).attr("cx",0).attr("cy",0);return H(t,o),t.intersect=function(c){return Q.info("Circle intersect",t,a,c),N.circle(t,a,c)},e})}k(ts,"circle");function es(l){let t=Math.cos(Math.PI/4),r=Math.sin(Math.PI/4),s=l*2,e={x:s/2*t,y:s/2*r},i={x:-(s/2)*t,y:s/2*r},h={x:-(s/2)*t,y:-(s/2)*r},a={x:s/2*t,y:-(s/2)*r};return`M ${i.x},${i.y} L ${a.x},${a.y}
                   M ${e.x},${e.y} L ${h.x},${h.y}`}k(es,"createLine");function ss(l,t){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r,t.label="";let e=l.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),i=Math.max(30,t?.width??0),{cssStyles:h}=t,a=M.svg(e),o=A(t,{});t.look!=="handDrawn"&&(o.roughness=0,o.fillStyle="solid");let n=a.circle(0,0,i*2,o),c=es(i),p=a.path(c,o),f=e.insert(()=>n,":first-child");return f.insert(()=>p),h&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",h),s&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",s),H(t,f),t.intersect=function(g){return Q.info("crossedCircle intersect",t,{radius:i,point:g}),N.circle(t,i,g)},e}k(ss,"crossedCircle");function ht(l,t,r,s=100,e=0,i=180){let h=[],a=e*Math.PI/180,c=(i*Math.PI/180-a)/(s-1);for(let p=0;p<s;p++){let f=a+p*c,g=l+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:-g,y:-u})}return h}k(ht,"generateCirclePoints");function as(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=i.width+(t.padding??0),o=i.height+(t.padding??0),n=Math.max(5,o*.1),{cssStyles:c}=t,p=[...ht(a/2,-o/2,n,30,-90,0),{x:-a/2-n,y:n},...ht(a/2+n*2,-n,n,20,-180,-270),...ht(a/2+n*2,n,n,20,-90,-180),{x:-a/2-n,y:-o/2},...ht(a/2,o/2,n,20,0,90)],f=[{x:a/2,y:-o/2-n},{x:-a/2,y:-o/2-n},...ht(a/2,-o/2,n,20,-90,0),{x:-a/2-n,y:-n},...ht(a/2+a*.1,-n,n,20,-180,-270),...ht(a/2+a*.1,n,n,20,-90,-180),{x:-a/2-n,y:o/2},...ht(a/2,o/2,n,20,0,90),{x:-a/2,y:o/2+n},{x:a/2,y:o/2+n}],g=M.svg(e),u=A(t,{fill:"none"});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let m=Z(p).replace("Z",""),d=g.path(m,u),x=Z(f),w=g.path(x,st({},u)),b=e.insert("g",":first-child");return b.insert(()=>w,":first-child").attr("stroke-opacity",0),b.insert(()=>d,":first-child"),b.attr("class","text"),c&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",c),s&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",s),b.attr("transform",`translate(${n}, 0)`),h.attr("transform",`translate(${-a/2+n-(i.x-(i.left??0))},${-o/2+(t.padding??0)/2-(i.y-(i.top??0))})`),H(t,b),t.intersect=function(v){return N.polygon(t,f,v)},e})}k(as,"curlyBraceLeft");function gt(l,t,r,s=100,e=0,i=180){let h=[],a=e*Math.PI/180,c=(i*Math.PI/180-a)/(s-1);for(let p=0;p<s;p++){let f=a+p*c,g=l+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:g,y:u})}return h}k(gt,"generateCirclePoints");function rs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=i.width+(t.padding??0),o=i.height+(t.padding??0),n=Math.max(5,o*.1),{cssStyles:c}=t,p=[...gt(a/2,-o/2,n,20,-90,0),{x:a/2+n,y:-n},...gt(a/2+n*2,-n,n,20,-180,-270),...gt(a/2+n*2,n,n,20,-90,-180),{x:a/2+n,y:o/2},...gt(a/2,o/2,n,20,0,90)],f=[{x:-a/2,y:-o/2-n},{x:a/2,y:-o/2-n},...gt(a/2,-o/2,n,20,-90,0),{x:a/2+n,y:-n},...gt(a/2+n*2,-n,n,20,-180,-270),...gt(a/2+n*2,n,n,20,-90,-180),{x:a/2+n,y:o/2},...gt(a/2,o/2,n,20,0,90),{x:a/2,y:o/2+n},{x:-a/2,y:o/2+n}],g=M.svg(e),u=A(t,{fill:"none"});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let m=Z(p).replace("Z",""),d=g.path(m,u),x=Z(f),w=g.path(x,st({},u)),b=e.insert("g",":first-child");return b.insert(()=>w,":first-child").attr("stroke-opacity",0),b.insert(()=>d,":first-child"),b.attr("class","text"),c&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",c),s&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",s),b.attr("transform",`translate(${-n}, 0)`),h.attr("transform",`translate(${-a/2+(t.padding??0)/2-(i.x-(i.left??0))},${-o/2+(t.padding??0)/2-(i.y-(i.top??0))})`),H(t,b),t.intersect=function(v){return N.polygon(t,f,v)},e})}k(rs,"curlyBraceRight");function et(l,t,r,s=100,e=0,i=180){let h=[],a=e*Math.PI/180,c=(i*Math.PI/180-a)/(s-1);for(let p=0;p<s;p++){let f=a+p*c,g=l+r*Math.cos(f),u=t+r*Math.sin(f);h.push({x:-g,y:-u})}return h}k(et,"generateCirclePoints");function is(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=i.width+(t.padding??0),o=i.height+(t.padding??0),n=Math.max(5,o*.1),{cssStyles:c}=t,p=[...et(a/2,-o/2,n,30,-90,0),{x:-a/2-n,y:n},...et(a/2+n*2,-n,n,20,-180,-270),...et(a/2+n*2,n,n,20,-90,-180),{x:-a/2-n,y:-o/2},...et(a/2,o/2,n,20,0,90)],f=[...et(-a/2+n+n/2,-o/2,n,20,-90,-180),{x:a/2-n/2,y:n},...et(-a/2-n/2,-n,n,20,0,90),...et(-a/2-n/2,n,n,20,-90,0),{x:a/2-n/2,y:-n},...et(-a/2+n+n/2,o/2,n,30,-180,-270)],g=[{x:a/2,y:-o/2-n},{x:-a/2,y:-o/2-n},...et(a/2,-o/2,n,20,-90,0),{x:-a/2-n,y:-n},...et(a/2+n*2,-n,n,20,-180,-270),...et(a/2+n*2,n,n,20,-90,-180),{x:-a/2-n,y:o/2},...et(a/2,o/2,n,20,0,90),{x:-a/2,y:o/2+n},{x:a/2-n-n/2,y:o/2+n},...et(-a/2+n+n/2,-o/2,n,20,-90,-180),{x:a/2-n/2,y:n},...et(-a/2-n/2,-n,n,20,0,90),...et(-a/2-n/2,n,n,20,-90,0),{x:a/2-n/2,y:-n},...et(-a/2+n+n/2,o/2,n,30,-180,-270)],u=M.svg(e),y=A(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let d=Z(p).replace("Z",""),x=u.path(d,y),b=Z(f).replace("Z",""),v=u.path(b,y),S=Z(g),D=u.path(S,st({},y)),$=e.insert("g",":first-child");return $.insert(()=>D,":first-child").attr("stroke-opacity",0),$.insert(()=>x,":first-child"),$.insert(()=>v,":first-child"),$.attr("class","text"),c&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",c),s&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",s),$.attr("transform",`translate(${n-n/4}, 0)`),h.attr("transform",`translate(${-a/2+(t.padding??0)/2-(i.x-(i.left??0))},${-o/2+(t.padding??0)/2-(i.y-(i.top??0))})`),H(t,$),t.intersect=function(P){return N.polygon(t,g,P)},e})}k(is,"curlyBraces");function ns(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=80,a=20,o=Math.max(h,(i.width+(t.padding??0)*2)*1.25,t?.width??0),n=Math.max(a,i.height+(t.padding??0)*2,t?.height??0),c=n/2,{cssStyles:p}=t,f=M.svg(e),g=A(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let u=o,y=n,m=u-c,d=y/4,x=[{x:m,y:0},{x:d,y:0},{x:0,y:y/2},{x:d,y},{x:m,y},...xe(-m,-y/2,c,50,270,90)],w=Z(x),b=f.path(w,g),v=e.insert(()=>b,":first-child");return v.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",p),s&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",s),v.attr("transform",`translate(${-o/2}, ${-n/2})`),H(t,v),t.intersect=function(S){return N.polygon(t,x,S)},e})}k(ns,"curvedTrapezoid");var va=k((l,t,r,s,e,i)=>[`M${l},${t+i}`,`a${e},${i} 0,0,0 ${r},0`,`a${e},${i} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${i} 0,0,0 ${r},0`,`l0,${-s}`].join(" "),"createCylinderPathD"),$a=k((l,t,r,s,e,i)=>[`M${l},${t+i}`,`M${l+r},${t+i}`,`a${e},${i} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${i} 0,0,0 ${r},0`,`l0,${-s}`].join(" "),"createOuterCylinderPathD"),Da=k((l,t,r,s,e,i)=>[`M${l-r/2},${-s/2}`,`a${e},${i} 0,0,0 ${r},0`].join(" "),"createInnerCylinderPathD");function ls(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=Math.max(i.width+t.padding,t.width??0),o=a/2,n=o/(2.5+a/50),c=Math.max(i.height+n+t.padding,t.height??0),p,{cssStyles:f}=t;if(t.look==="handDrawn"){let g=M.svg(e),u=$a(0,0,a,c,o,n),y=Da(0,n,a,c,o,n),m=g.path(u,A(t,{})),d=g.path(y,A(t,{fill:"none"}));p=e.insert(()=>d,":first-child"),p=e.insert(()=>m,":first-child"),p.attr("class","basic label-container"),f&&p.attr("style",f)}else{let g=va(0,0,a,c,o,n);p=e.insert("path",":first-child").attr("d",g).attr("class","basic label-container").attr("style",at(f)).attr("style",s)}return p.attr("label-offset-y",n),p.attr("transform",`translate(${-a/2}, ${-(c/2+n)})`),H(t,p),h.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+(t.padding??0)/1.5-(i.y-(i.top??0))})`),t.intersect=function(g){let u=N.rect(t,g),y=u.x-(t.x??0);if(o!=0&&(Math.abs(y)<(t.width??0)/2||Math.abs(y)==(t.width??0)/2&&Math.abs(u.y-(t.y??0))>(t.height??0)/2-n)){let m=n*n*(1-y*y/(o*o));m>0&&(m=Math.sqrt(m)),m=n-m,g.y-(t.y??0)>0&&(m=-m),u.y+=m}return u},e})}k(ls,"cylinder");function cs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=i.width+t.padding,o=i.height+t.padding,n=o*.2,c=-a/2,p=-o/2-n/2,{cssStyles:f}=t,g=M.svg(e),u=A(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:c,y:p+n},{x:-c,y:p+n},{x:-c,y:-p},{x:c,y:-p},{x:c,y:p},{x:-c,y:p},{x:-c,y:p+n}],m=g.polygon(y.map(x=>[x.x,x.y]),u),d=e.insert(()=>m,":first-child");return d.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),h.attr("transform",`translate(${c+(t.padding??0)/2-(i.x-(i.left??0))}, ${p+n+(t.padding??0)/2-(i.y-(i.top??0))})`),H(t,d),t.intersect=function(x){return N.rect(t,x)},e})}k(cs,"dividedRectangle");function os(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,halfPadding:h}=yield X(l,t,G(t)),o=i.width/2+h+5,n=i.width/2+h,c,{cssStyles:p}=t;if(t.look==="handDrawn"){let f=M.svg(e),g=A(t,{roughness:.2,strokeWidth:2.5}),u=A(t,{roughness:.2,strokeWidth:1.5}),y=f.circle(0,0,o*2,g),m=f.circle(0,0,n*2,u);c=e.insert("g",":first-child"),c.attr("class",at(t.cssClasses)).attr("style",at(p)),c.node()?.appendChild(y),c.node()?.appendChild(m)}else{c=e.insert("g",":first-child");let f=c.insert("circle",":first-child"),g=c.insert("circle");c.attr("class","basic label-container").attr("style",s),f.attr("class","outer-circle").attr("style",s).attr("r",o).attr("cx",0).attr("cy",0),g.attr("class","inner-circle").attr("style",s).attr("r",n).attr("cx",0).attr("cy",0)}return H(t,c),t.intersect=function(f){return Q.info("DoubleCircle intersect",t,o,f),N.circle(t,o,f)},e})}k(os,"doublecircle");function hs(l,t,{config:{themeVariables:r}}){let{labelStyles:s,nodeStyles:e}=W(t);t.label="",t.labelStyle=s;let i=l.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),h=7,{cssStyles:a}=t,o=M.svg(i),{nodeBorder:n}=r,c=A(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(c.roughness=0);let p=o.circle(0,0,h*2,c),f=i.insert(()=>p,":first-child");return f.selectAll("path").attr("style",`fill: ${n} !important;`),a&&a.length>0&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",a),e&&t.look!=="handDrawn"&&f.selectAll("path").attr("style",e),H(t,f),t.intersect=function(g){return Q.info("filledCircle intersect",t,{radius:h,point:g}),N.circle(t,h,g)},i}k(hs,"filledCircle");function gs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=i.width+(t.padding??0),o=a+i.height,n=a+i.height,c=[{x:0,y:-o},{x:n,y:-o},{x:n/2,y:0}],{cssStyles:p}=t,f=M.svg(e),g=A(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let u=Z(c),y=f.path(u,g),m=e.insert(()=>y,":first-child").attr("transform",`translate(${-o/2}, ${o/2})`);return p&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",p),s&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",s),t.width=a,t.height=o,H(t,m),h.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-o/2+(t.padding??0)/2+(i.y-(i.top??0))})`),t.intersect=function(d){return Q.info("Triangle intersect",t,c,d),N.polygon(t,c,d)},e})}k(gs,"flippedTriangle");function ps(l,t,{dir:r,config:{state:s,themeVariables:e}}){let{nodeStyles:i}=W(t);t.label="";let h=l.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),{cssStyles:a}=t,o=Math.max(70,t?.width??0),n=Math.max(10,t?.height??0);r==="LR"&&(o=Math.max(10,t?.width??0),n=Math.max(70,t?.height??0));let c=-1*o/2,p=-1*n/2,f=M.svg(h),g=A(t,{stroke:e.lineColor,fill:e.lineColor});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let u=f.rectangle(c,p,o,n,g),y=h.insert(()=>u,":first-child");a&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",a),i&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",i),H(t,y);let m=s?.padding??0;return t.width&&t.height&&(t.width+=m/2||0,t.height+=m/2||0),t.intersect=function(d){return N.rect(t,d)},h}k(ps,"forkJoin");function fs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let e=80,i=50,{shapeSvg:h,bbox:a}=yield X(l,t,G(t)),o=Math.max(e,a.width+(t.padding??0)*2,t?.width??0),n=Math.max(i,a.height+(t.padding??0)*2,t?.height??0),c=n/2,{cssStyles:p}=t,f=M.svg(h),g=A(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let u=[{x:-o/2,y:-n/2},{x:o/2-c,y:-n/2},...xe(-o/2+c,0,c,50,90,270),{x:o/2-c,y:n/2},{x:-o/2,y:n/2}],y=Z(u),m=f.path(y,g),d=h.insert(()=>m,":first-child");return d.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",p),s&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",s),H(t,d),t.intersect=function(x){return Q.info("Pill intersect",t,{radius:c,point:x}),N.polygon(t,u,x)},h})}k(fs,"halfRoundedRectangle");var Pa=k((l,t,r,s,e)=>[`M${l+e},${t}`,`L${l+r-e},${t}`,`L${l+r},${t-s/2}`,`L${l+r-e},${t-s}`,`L${l+e},${t-s}`,`L${l},${t-s/2}`,"Z"].join(" "),"createHexagonPathD");function us(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=4,a=i.height+t.padding,o=a/h,n=i.width+2*o+t.padding,c=[{x:o,y:0},{x:n-o,y:0},{x:n,y:-a/2},{x:n-o,y:-a},{x:o,y:-a},{x:0,y:-a/2}],p,{cssStyles:f}=t;if(t.look==="handDrawn"){let g=M.svg(e),u=A(t,{}),y=Pa(0,0,n,a,o),m=g.path(y,u);p=e.insert(()=>m,":first-child").attr("transform",`translate(${-n/2}, ${a/2})`),f&&p.attr("style",f)}else p=ft(e,n,a,c);return s&&p.attr("style",s),t.width=n,t.height=a,H(t,p),t.intersect=function(g){return N.polygon(t,c,g)},e})}k(us,"hexagon");function ys(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.label="",t.labelStyle=r;let{shapeSvg:e}=yield X(l,t,G(t)),i=Math.max(30,t?.width??0),h=Math.max(30,t?.height??0),{cssStyles:a}=t,o=M.svg(e),n=A(t,{});t.look!=="handDrawn"&&(n.roughness=0,n.fillStyle="solid");let c=[{x:0,y:0},{x:i,y:0},{x:0,y:h},{x:i,y:h}],p=Z(c),f=o.path(p,n),g=e.insert(()=>f,":first-child");return g.attr("class","basic label-container"),a&&t.look!=="handDrawn"&&g.selectChildren("path").attr("style",a),s&&t.look!=="handDrawn"&&g.selectChildren("path").attr("style",s),g.attr("transform",`translate(${-i/2}, ${-h/2})`),H(t,g),t.intersect=function(u){return Q.info("Pill intersect",t,{points:c}),N.polygon(t,c,u)},e})}k(ys,"hourglass");function ds(e,i,h){return L(this,arguments,function*(l,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=W(t);t.labelStyle=a;let o=t.assetHeight??48,n=t.assetWidth??48,c=Math.max(o,n),p=s?.wrappingWidth;t.width=Math.max(c,p??0);let{shapeSvg:f,bbox:g,label:u}=yield X(l,t,"icon-shape default"),y=t.pos==="t",m=c,d=c,{nodeBorder:x}=r,{stylesMap:w}=Dt(t),b=-d/2,v=-m/2,S=t.label?8:0,D=M.svg(f),$=A(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&($.roughness=0,$.fillStyle="solid");let P=D.rectangle(b,v,d,m,$),C=Math.max(d,g.width),O=m+g.height+S,V=D.rectangle(-C/2,-O/2,C,O,lt(st({},$),{fill:"transparent",stroke:"none"})),E=f.insert(()=>P,":first-child"),B=f.insert(()=>V);if(t.icon){let I=f.append("g");I.html(`<g>${yield Bt(t.icon,{height:c,width:c,fallbackPrefix:""})}</g>`);let R=I.node().getBBox(),q=R.width,z=R.height,T=R.x,F=R.y;I.attr("transform",`translate(${-q/2-T},${y?g.height/2+S/2-z/2-F:-g.height/2-S/2-z/2-F})`),I.attr("style",`color: ${w.get("stroke")??x};`)}return u.attr("transform",`translate(${-g.width/2-(g.x-(g.left??0))},${y?-O/2:O/2-g.height})`),E.attr("transform",`translate(0,${y?g.height/2+S/2:-g.height/2-S/2})`),H(t,B),t.intersect=function(I){if(Q.info("iconSquare intersect",t,I),!t.label)return N.rect(t,I);let R=t.x??0,q=t.y??0,z=t.height??0,T=[];return y?T=[{x:R-g.width/2,y:q-z/2},{x:R+g.width/2,y:q-z/2},{x:R+g.width/2,y:q-z/2+g.height+S},{x:R+d/2,y:q-z/2+g.height+S},{x:R+d/2,y:q+z/2},{x:R-d/2,y:q+z/2},{x:R-d/2,y:q-z/2+g.height+S},{x:R-g.width/2,y:q-z/2+g.height+S}]:T=[{x:R-d/2,y:q-z/2},{x:R+d/2,y:q-z/2},{x:R+d/2,y:q-z/2+m},{x:R+g.width/2,y:q-z/2+m},{x:R+g.width/2/2,y:q+z/2},{x:R-g.width/2,y:q+z/2},{x:R-g.width/2,y:q-z/2+m},{x:R-d/2,y:q-z/2+m}],N.polygon(t,T,I)},f})}k(ds,"icon");function ms(e,i,h){return L(this,arguments,function*(l,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=W(t);t.labelStyle=a;let o=t.assetHeight??48,n=t.assetWidth??48,c=Math.max(o,n),p=s?.wrappingWidth;t.width=Math.max(c,p??0);let{shapeSvg:f,bbox:g,label:u}=yield X(l,t,"icon-shape default"),y=20,m=t.label?8:0,d=t.pos==="t",{nodeBorder:x,mainBkg:w}=r,{stylesMap:b}=Dt(t),v=M.svg(f),S=A(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");let D=b.get("fill");S.stroke=D??w;let $=f.append("g");t.icon&&$.html(`<g>${yield Bt(t.icon,{height:c,width:c,fallbackPrefix:""})}</g>`);let P=$.node().getBBox(),C=P.width,O=P.height,V=P.x,E=P.y,B=Math.max(C,O)*Math.SQRT2+y*2,I=v.circle(0,0,B,S),R=Math.max(B,g.width),q=B+g.height+m,z=v.rectangle(-R/2,-q/2,R,q,lt(st({},S),{fill:"transparent",stroke:"none"})),T=f.insert(()=>I,":first-child"),F=f.insert(()=>z);return $.attr("transform",`translate(${-C/2-V},${d?g.height/2+m/2-O/2-E:-g.height/2-m/2-O/2-E})`),$.attr("style",`color: ${b.get("stroke")??x};`),u.attr("transform",`translate(${-g.width/2-(g.x-(g.left??0))},${d?-q/2:q/2-g.height})`),T.attr("transform",`translate(0,${d?g.height/2+m/2:-g.height/2-m/2})`),H(t,F),t.intersect=function(_){return Q.info("iconSquare intersect",t,_),N.rect(t,_)},f})}k(ms,"iconCircle");function xs(e,i,h){return L(this,arguments,function*(l,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=W(t);t.labelStyle=a;let o=t.assetHeight??48,n=t.assetWidth??48,c=Math.max(o,n),p=s?.wrappingWidth;t.width=Math.max(c,p??0);let{shapeSvg:f,bbox:g,halfPadding:u,label:y}=yield X(l,t,"icon-shape default"),m=t.pos==="t",d=c+u*2,x=c+u*2,{nodeBorder:w,mainBkg:b}=r,{stylesMap:v}=Dt(t),S=-x/2,D=-d/2,$=t.label?8:0,P=M.svg(f),C=A(t,{});t.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid");let O=v.get("fill");C.stroke=O??b;let V=P.path(pt(S,D,x,d,5),C),E=Math.max(x,g.width),B=d+g.height+$,I=P.rectangle(-E/2,-B/2,E,B,lt(st({},C),{fill:"transparent",stroke:"none"})),R=f.insert(()=>V,":first-child").attr("class","icon-shape2"),q=f.insert(()=>I);if(t.icon){let z=f.append("g");z.html(`<g>${yield Bt(t.icon,{height:c,width:c,fallbackPrefix:""})}</g>`);let T=z.node().getBBox(),F=T.width,_=T.height,Y=T.x,J=T.y;z.attr("transform",`translate(${-F/2-Y},${m?g.height/2+$/2-_/2-J:-g.height/2-$/2-_/2-J})`),z.attr("style",`color: ${v.get("stroke")??w};`)}return y.attr("transform",`translate(${-g.width/2-(g.x-(g.left??0))},${m?-B/2:B/2-g.height})`),R.attr("transform",`translate(0,${m?g.height/2+$/2:-g.height/2-$/2})`),H(t,q),t.intersect=function(z){if(Q.info("iconSquare intersect",t,z),!t.label)return N.rect(t,z);let T=t.x??0,F=t.y??0,_=t.height??0,Y=[];return m?Y=[{x:T-g.width/2,y:F-_/2},{x:T+g.width/2,y:F-_/2},{x:T+g.width/2,y:F-_/2+g.height+$},{x:T+x/2,y:F-_/2+g.height+$},{x:T+x/2,y:F+_/2},{x:T-x/2,y:F+_/2},{x:T-x/2,y:F-_/2+g.height+$},{x:T-g.width/2,y:F-_/2+g.height+$}]:Y=[{x:T-x/2,y:F-_/2},{x:T+x/2,y:F-_/2},{x:T+x/2,y:F-_/2+d},{x:T+g.width/2,y:F-_/2+d},{x:T+g.width/2/2,y:F+_/2},{x:T-g.width/2,y:F+_/2},{x:T-g.width/2,y:F-_/2+d},{x:T-x/2,y:F-_/2+d}],N.polygon(t,Y,z)},f})}k(xs,"iconRounded");function bs(e,i,h){return L(this,arguments,function*(l,t,{config:{themeVariables:r,flowchart:s}}){let{labelStyles:a}=W(t);t.labelStyle=a;let o=t.assetHeight??48,n=t.assetWidth??48,c=Math.max(o,n),p=s?.wrappingWidth;t.width=Math.max(c,p??0);let{shapeSvg:f,bbox:g,halfPadding:u,label:y}=yield X(l,t,"icon-shape default"),m=t.pos==="t",d=c+u*2,x=c+u*2,{nodeBorder:w,mainBkg:b}=r,{stylesMap:v}=Dt(t),S=-x/2,D=-d/2,$=t.label?8:0,P=M.svg(f),C=A(t,{});t.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid");let O=v.get("fill");C.stroke=O??b;let V=P.path(pt(S,D,x,d,.1),C),E=Math.max(x,g.width),B=d+g.height+$,I=P.rectangle(-E/2,-B/2,E,B,lt(st({},C),{fill:"transparent",stroke:"none"})),R=f.insert(()=>V,":first-child"),q=f.insert(()=>I);if(t.icon){let z=f.append("g");z.html(`<g>${yield Bt(t.icon,{height:c,width:c,fallbackPrefix:""})}</g>`);let T=z.node().getBBox(),F=T.width,_=T.height,Y=T.x,J=T.y;z.attr("transform",`translate(${-F/2-Y},${m?g.height/2+$/2-_/2-J:-g.height/2-$/2-_/2-J})`),z.attr("style",`color: ${v.get("stroke")??w};`)}return y.attr("transform",`translate(${-g.width/2-(g.x-(g.left??0))},${m?-B/2:B/2-g.height})`),R.attr("transform",`translate(0,${m?g.height/2+$/2:-g.height/2-$/2})`),H(t,q),t.intersect=function(z){if(Q.info("iconSquare intersect",t,z),!t.label)return N.rect(t,z);let T=t.x??0,F=t.y??0,_=t.height??0,Y=[];return m?Y=[{x:T-g.width/2,y:F-_/2},{x:T+g.width/2,y:F-_/2},{x:T+g.width/2,y:F-_/2+g.height+$},{x:T+x/2,y:F-_/2+g.height+$},{x:T+x/2,y:F+_/2},{x:T-x/2,y:F+_/2},{x:T-x/2,y:F-_/2+g.height+$},{x:T-g.width/2,y:F-_/2+g.height+$}]:Y=[{x:T-x/2,y:F-_/2},{x:T+x/2,y:F-_/2},{x:T+x/2,y:F-_/2+d},{x:T+g.width/2,y:F-_/2+d},{x:T+g.width/2/2,y:F+_/2},{x:T-g.width/2,y:F+_/2},{x:T-g.width/2,y:F-_/2+d},{x:T-x/2,y:F-_/2+d}],N.polygon(t,Y,z)},f})}k(bs,"iconSquare");function ws(s,e,i){return L(this,arguments,function*(l,t,{config:{flowchart:r}}){let h=new Image;h.src=t?.img??"",yield h.decode();let a=Number(h.naturalWidth.toString().replace("px","")),o=Number(h.naturalHeight.toString().replace("px",""));t.imageAspectRatio=a/o;let{labelStyles:n}=W(t);t.labelStyle=n;let c=r?.wrappingWidth;t.defaultWidth=r?.wrappingWidth;let p=Math.max(t.label?c??0:0,t?.assetWidth??a),f=t.constraint==="on"&&t?.assetHeight?t.assetHeight*t.imageAspectRatio:p,g=t.constraint==="on"?f/t.imageAspectRatio:t?.assetHeight??o;t.width=Math.max(f,c??0);let{shapeSvg:u,bbox:y,label:m}=yield X(l,t,"image-shape default"),d=t.pos==="t",x=-f/2,w=-g/2,b=t.label?8:0,v=M.svg(u),S=A(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");let D=v.rectangle(x,w,f,g,S),$=Math.max(f,y.width),P=g+y.height+b,C=v.rectangle(-$/2,-P/2,$,P,lt(st({},S),{fill:"none",stroke:"none"})),O=u.insert(()=>D,":first-child"),V=u.insert(()=>C);if(t.img){let E=u.append("image");E.attr("href",t.img),E.attr("width",f),E.attr("height",g),E.attr("preserveAspectRatio","none"),E.attr("transform",`translate(${-f/2},${d?P/2-g:-P/2})`)}return m.attr("transform",`translate(${-y.width/2-(y.x-(y.left??0))},${d?-g/2-y.height/2-b/2:g/2-y.height/2+b/2})`),O.attr("transform",`translate(0,${d?y.height/2+b/2:-y.height/2-b/2})`),H(t,V),t.intersect=function(E){if(Q.info("iconSquare intersect",t,E),!t.label)return N.rect(t,E);let B=t.x??0,I=t.y??0,R=t.height??0,q=[];return d?q=[{x:B-y.width/2,y:I-R/2},{x:B+y.width/2,y:I-R/2},{x:B+y.width/2,y:I-R/2+y.height+b},{x:B+f/2,y:I-R/2+y.height+b},{x:B+f/2,y:I+R/2},{x:B-f/2,y:I+R/2},{x:B-f/2,y:I-R/2+y.height+b},{x:B-y.width/2,y:I-R/2+y.height+b}]:q=[{x:B-f/2,y:I-R/2},{x:B+f/2,y:I-R/2},{x:B+f/2,y:I-R/2+g},{x:B+y.width/2,y:I-R/2+g},{x:B+y.width/2/2,y:I+R/2},{x:B-y.width/2,y:I+R/2},{x:B-y.width/2,y:I-R/2+g},{x:B-f/2,y:I-R/2+g}],N.polygon(t,q,E)},u})}k(ws,"imageSquare");function Ss(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=Math.max(i.width+(t.padding??0)*2,t?.width??0),a=Math.max(i.height+(t.padding??0)*2,t?.height??0),o=[{x:0,y:0},{x:h,y:0},{x:h+3*a/6,y:-a},{x:-3*a/6,y:-a}],n,{cssStyles:c}=t;if(t.look==="handDrawn"){let p=M.svg(e),f=A(t,{}),g=Z(o),u=p.path(g,f);n=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),c&&n.attr("style",c)}else n=ft(e,h,a,o);return s&&n.attr("style",s),t.width=h,t.height=a,H(t,n),t.intersect=function(p){return N.polygon(t,o,p)},e})}k(Ss,"inv_trapezoid");function Tt(l,t,r){return L(this,null,function*(){let{labelStyles:s,nodeStyles:e}=W(t);t.labelStyle=s;let{shapeSvg:i,bbox:h}=yield X(l,t,G(t)),a=Math.max(h.width+r.labelPaddingX*2,t?.width||0),o=Math.max(h.height+r.labelPaddingY*2,t?.height||0),n=-a/2,c=-o/2,p,{rx:f,ry:g}=t,{cssStyles:u}=t;if(r?.rx&&r.ry&&(f=r.rx,g=r.ry),t.look==="handDrawn"){let y=M.svg(i),m=A(t,{}),d=f||g?y.path(pt(n,c,a,o,f||0),m):y.rectangle(n,c,a,o,m);p=i.insert(()=>d,":first-child"),p.attr("class","basic label-container").attr("style",at(u))}else p=i.insert("rect",":first-child"),p.attr("class","basic label-container").attr("style",e).attr("rx",at(f)).attr("ry",at(g)).attr("x",n).attr("y",c).attr("width",a).attr("height",o);return H(t,p),t.intersect=function(y){return N.rect(t,y)},i})}k(Tt,"drawRect");function ks(l,t){return L(this,null,function*(){let{shapeSvg:r,bbox:s,label:e}=yield X(l,t,"label"),i=r.insert("rect",":first-child");return i.attr("width",.1).attr("height",.1),r.attr("class","label edgeLabel"),e.attr("transform",`translate(${-(s.width/2)-(s.x-(s.left??0))}, ${-(s.height/2)-(s.y-(s.top??0))})`),H(t,i),t.intersect=function(o){return N.rect(t,o)},r})}k(ks,"labelRect");function Ms(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=Math.max(i.width+(t.padding??0),t?.width??0),a=Math.max(i.height+(t.padding??0),t?.height??0),o=[{x:0,y:0},{x:h+3*a/6,y:0},{x:h,y:-a},{x:-(3*a)/6,y:-a}],n,{cssStyles:c}=t;if(t.look==="handDrawn"){let p=M.svg(e),f=A(t,{}),g=Z(o),u=p.path(g,f);n=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),c&&n.attr("style",c)}else n=ft(e,h,a,o);return s&&n.attr("style",s),t.width=h,t.height=a,H(t,n),t.intersect=function(p){return N.polygon(t,o,p)},e})}k(Ms,"lean_left");function vs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=Math.max(i.width+(t.padding??0),t?.width??0),a=Math.max(i.height+(t.padding??0),t?.height??0),o=[{x:-3*a/6,y:0},{x:h,y:0},{x:h+3*a/6,y:-a},{x:0,y:-a}],n,{cssStyles:c}=t;if(t.look==="handDrawn"){let p=M.svg(e),f=A(t,{}),g=Z(o),u=p.path(g,f);n=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),c&&n.attr("style",c)}else n=ft(e,h,a,o);return s&&n.attr("style",s),t.width=h,t.height=a,H(t,n),t.intersect=function(p){return N.polygon(t,o,p)},e})}k(vs,"lean_right");function $s(l,t){let{labelStyles:r,nodeStyles:s}=W(t);t.label="",t.labelStyle=r;let e=l.insert("g").attr("class",G(t)).attr("id",t.domId??t.id),{cssStyles:i}=t,h=Math.max(35,t?.width??0),a=Math.max(35,t?.height??0),o=7,n=[{x:h,y:0},{x:0,y:a+o/2},{x:h-2*o,y:a+o/2},{x:0,y:2*a},{x:h,y:a-o/2},{x:2*o,y:a-o/2}],c=M.svg(e),p=A(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let f=Z(n),g=c.path(f,p),u=e.insert(()=>g,":first-child");return i&&t.look!=="handDrawn"&&u.selectAll("path").attr("style",i),s&&t.look!=="handDrawn"&&u.selectAll("path").attr("style",s),u.attr("transform",`translate(-${h/2},${-a})`),H(t,u),t.intersect=function(y){return Q.info("lightningBolt intersect",t,y),N.polygon(t,n,y)},e}k($s,"lightningBolt");var Ba=k((l,t,r,s,e,i,h)=>[`M${l},${t+i}`,`a${e},${i} 0,0,0 ${r},0`,`a${e},${i} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${i} 0,0,0 ${r},0`,`l0,${-s}`,`M${l},${t+i+h}`,`a${e},${i} 0,0,0 ${r},0`].join(" "),"createCylinderPathD"),Ca=k((l,t,r,s,e,i,h)=>[`M${l},${t+i}`,`M${l+r},${t+i}`,`a${e},${i} 0,0,0 ${-r},0`,`l0,${s}`,`a${e},${i} 0,0,0 ${r},0`,`l0,${-s}`,`M${l},${t+i+h}`,`a${e},${i} 0,0,0 ${r},0`].join(" "),"createOuterCylinderPathD"),Ra=k((l,t,r,s,e,i)=>[`M${l-r/2},${-s/2}`,`a${e},${i} 0,0,0 ${r},0`].join(" "),"createInnerCylinderPathD");function Ds(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=Math.max(i.width+(t.padding??0),t.width??0),o=a/2,n=o/(2.5+a/50),c=Math.max(i.height+n+(t.padding??0),t.height??0),p=c*.1,f,{cssStyles:g}=t;if(t.look==="handDrawn"){let u=M.svg(e),y=Ca(0,0,a,c,o,n,p),m=Ra(0,n,a,c,o,n),d=A(t,{}),x=u.path(y,d),w=u.path(m,d);e.insert(()=>w,":first-child").attr("class","line"),f=e.insert(()=>x,":first-child"),f.attr("class","basic label-container"),g&&f.attr("style",g)}else{let u=Ba(0,0,a,c,o,n,p);f=e.insert("path",":first-child").attr("d",u).attr("class","basic label-container").attr("style",at(g)).attr("style",s)}return f.attr("label-offset-y",n),f.attr("transform",`translate(${-a/2}, ${-(c/2+n)})`),H(t,f),h.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+n-(i.y-(i.top??0))})`),t.intersect=function(u){let y=N.rect(t,u),m=y.x-(t.x??0);if(o!=0&&(Math.abs(m)<(t.width??0)/2||Math.abs(m)==(t.width??0)/2&&Math.abs(y.y-(t.y??0))>(t.height??0)/2-n)){let d=n*n*(1-m*m/(o*o));d>0&&(d=Math.sqrt(d)),d=n-d,u.y-(t.y??0)>0&&(d=-d),y.y+=d}return y},e})}k(Ds,"linedCylinder");function Ps(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),o=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=o/4,c=o+n,{cssStyles:p}=t,f=M.svg(e),g=A(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let u=[{x:-a/2-a/2*.1,y:-c/2},{x:-a/2-a/2*.1,y:c/2},...mt(-a/2-a/2*.1,c/2,a/2+a/2*.1,c/2,n,.8),{x:a/2+a/2*.1,y:-c/2},{x:-a/2-a/2*.1,y:-c/2},{x:-a/2,y:-c/2},{x:-a/2,y:c/2*1.1},{x:-a/2,y:-c/2}],y=f.polygon(u.map(d=>[d.x,d.y]),g),m=e.insert(()=>y,":first-child");return m.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",p),s&&t.look!=="handDrawn"&&m.selectAll("path").attr("style",s),m.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)+a/2*.1/2-(i.x-(i.left??0))},${-o/2+(t.padding??0)-n/2-(i.y-(i.top??0))})`),H(t,m),t.intersect=function(d){return N.polygon(t,u,d)},e})}k(Ps,"linedWaveEdgedRect");function Bs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),o=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=5,c=-a/2,p=-o/2,{cssStyles:f}=t,g=M.svg(e),u=A(t,{}),y=[{x:c-n,y:p+n},{x:c-n,y:p+o+n},{x:c+a-n,y:p+o+n},{x:c+a-n,y:p+o},{x:c+a,y:p+o},{x:c+a,y:p+o-n},{x:c+a+n,y:p+o-n},{x:c+a+n,y:p-n},{x:c+n,y:p-n},{x:c+n,y:p},{x:c,y:p},{x:c,y:p+n}],m=[{x:c,y:p+n},{x:c+a-n,y:p+n},{x:c+a-n,y:p+o},{x:c+a,y:p+o},{x:c+a,y:p},{x:c,y:p}];t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=Z(y),x=g.path(d,u),w=Z(m),b=g.path(w,lt(st({},u),{fill:"none"})),v=e.insert(()=>b,":first-child");return v.insert(()=>x,":first-child"),v.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",s),h.attr("transform",`translate(${-(i.width/2)-n-(i.x-(i.left??0))}, ${-(i.height/2)+n-(i.y-(i.top??0))})`),H(t,v),t.intersect=function(S){return N.polygon(t,y,S)},e})}k(Bs,"multiRect");function Cs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),o=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=o/4,c=o+n,p=-a/2,f=-c/2,g=5,{cssStyles:u}=t,y=mt(p-g,f+c+g,p+a-g,f+c+g,n,.8),m=y?.[y.length-1],d=[{x:p-g,y:f+g},{x:p-g,y:f+c+g},...y,{x:p+a-g,y:m.y-g},{x:p+a,y:m.y-g},{x:p+a,y:m.y-2*g},{x:p+a+g,y:m.y-2*g},{x:p+a+g,y:f-g},{x:p+g,y:f-g},{x:p+g,y:f},{x:p,y:f},{x:p,y:f+g}],x=[{x:p,y:f+g},{x:p+a-g,y:f+g},{x:p+a-g,y:m.y-g},{x:p+a,y:m.y-g},{x:p+a,y:f},{x:p,y:f}],w=M.svg(e),b=A(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");let v=Z(d),S=w.path(v,b),D=Z(x),$=w.path(D,b),P=e.insert(()=>S,":first-child");return P.insert(()=>$),P.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&P.selectAll("path").attr("style",u),s&&t.look!=="handDrawn"&&P.selectAll("path").attr("style",s),P.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-(i.width/2)-g-(i.x-(i.left??0))}, ${-(i.height/2)+g-n/2-(i.y-(i.top??0))})`),H(t,P),t.intersect=function(C){return N.polygon(t,d,C)},e})}k(Cs,"multiWaveEdgedRectangle");function Rs(s,e,i){return L(this,arguments,function*(l,t,{config:{themeVariables:r}}){let{labelStyles:h,nodeStyles:a}=W(t);t.labelStyle=h,t.useHtmlLabels||wt().flowchart?.htmlLabels!==!1||(t.centerLabel=!0);let{shapeSvg:n,bbox:c}=yield X(l,t,G(t)),p=Math.max(c.width+(t.padding??0)*2,t?.width??0),f=Math.max(c.height+(t.padding??0)*2,t?.height??0),g=-p/2,u=-f/2,{cssStyles:y}=t,m=M.svg(n),d=A(t,{fill:r.noteBkgColor,stroke:r.noteBorderColor});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");let x=m.rectangle(g,u,p,f,d),w=n.insert(()=>x,":first-child");return w.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",y),a&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",a),H(t,w),t.intersect=function(b){return N.rect(t,b)},n})}k(Rs,"note");var La=k((l,t,r)=>[`M${l+r/2},${t}`,`L${l+r},${t-r/2}`,`L${l+r/2},${t-r}`,`L${l},${t-r/2}`,"Z"].join(" "),"createDecisionBoxPathD");function Ls(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=i.width+t.padding,a=i.height+t.padding,o=h+a,n=[{x:o/2,y:0},{x:o,y:-o/2},{x:o/2,y:-o},{x:0,y:-o/2}],c,{cssStyles:p}=t;if(t.look==="handDrawn"){let f=M.svg(e),g=A(t,{}),u=La(0,0,o),y=f.path(u,g);c=e.insert(()=>y,":first-child").attr("transform",`translate(${-o/2}, ${o/2})`),p&&c.attr("style",p)}else c=ft(e,o,o,n);return s&&c.attr("style",s),H(t,c),t.intersect=function(f){return Q.debug(`APA12 Intersect called SPLIT
point:`,f,`
node:
`,t,`
res:`,N.polygon(t,n,f)),N.polygon(t,n,f)},e})}k(Ls,"question");function Ns(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=Math.max(i.width+(t.padding??0),t?.width??0),o=Math.max(i.height+(t.padding??0),t?.height??0),n=-a/2,c=-o/2,p=c/2,f=[{x:n+p,y:c},{x:n,y:0},{x:n+p,y:-c},{x:-n,y:-c},{x:-n,y:c}],{cssStyles:g}=t,u=M.svg(e),y=A(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let m=Z(f),d=u.path(m,y),x=e.insert(()=>d,":first-child");return x.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",g),s&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",s),x.attr("transform",`translate(${-p/2},0)`),h.attr("transform",`translate(${-p/2-i.width/2-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),H(t,x),t.intersect=function(w){return N.polygon(t,f,w)},e})}k(Ns,"rect_left_inv_arrow");function As(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let e;t.cssClasses?e="node "+t.cssClasses:e="node default";let i=l.insert("g").attr("class",e).attr("id",t.domId||t.id),h=i.insert("g"),a=i.insert("g").attr("class","label").attr("style",s),o=t.description,n=t.label,c=a.node().appendChild(yield ye(n,t.labelStyle,!0,!0)),p={width:0,height:0};if(tt(U()?.flowchart?.htmlLabels)){let $=c.children[0],P=K(c);p=$.getBoundingClientRect(),P.attr("width",p.width),P.attr("height",p.height)}Q.info("Text 2",o);let f=o||[],g=c.getBBox(),u=a.node().appendChild(yield ye(f.join?f.join("<br/>"):f,t.labelStyle,!0,!0)),y=u.children[0],m=K(u);p=y.getBoundingClientRect(),m.attr("width",p.width),m.attr("height",p.height);let d=(t.padding||0)/2;K(u).attr("transform","translate( "+(p.width>g.width?0:(g.width-p.width)/2)+", "+(g.height+d+5)+")"),K(c).attr("transform","translate( "+(p.width<g.width?0:-(g.width-p.width)/2)+", 0)"),p=a.node().getBBox(),a.attr("transform","translate("+-p.width/2+", "+(-p.height/2-d+3)+")");let x=p.width+(t.padding||0),w=p.height+(t.padding||0),b=-p.width/2-d,v=-p.height/2-d,S,D;if(t.look==="handDrawn"){let $=M.svg(i),P=A(t,{}),C=$.path(pt(b,v,x,w,t.rx||0),P),O=$.line(-p.width/2-d,-p.height/2-d+g.height+d,p.width/2+d,-p.height/2-d+g.height+d,P);D=i.insert(()=>(Q.debug("Rough node insert CXC",C),O),":first-child"),S=i.insert(()=>(Q.debug("Rough node insert CXC",C),C),":first-child")}else S=h.insert("rect",":first-child"),D=h.insert("line"),S.attr("class","outer title-state").attr("style",s).attr("x",-p.width/2-d).attr("y",-p.height/2-d).attr("width",p.width+(t.padding||0)).attr("height",p.height+(t.padding||0)),D.attr("class","divider").attr("x1",-p.width/2-d).attr("x2",p.width/2+d).attr("y1",-p.height/2-d+g.height+d).attr("y2",-p.height/2-d+g.height+d);return H(t,S),t.intersect=function($){return N.rect(t,$)},i})}k(As,"rectWithTitle");function Ts(l,t){return L(this,null,function*(){let r={rx:5,ry:5,classes:"",labelPaddingX:(t?.padding||0)*1,labelPaddingY:(t?.padding||0)*1};return Tt(l,t,r)})}k(Ts,"roundedRect");function Ws(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=t?.padding??0,o=Math.max(i.width+(t.padding??0)*2,t?.width??0),n=Math.max(i.height+(t.padding??0)*2,t?.height??0),c=-i.width/2-a,p=-i.height/2-a,{cssStyles:f}=t,g=M.svg(e),u=A(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=[{x:c,y:p},{x:c+o+8,y:p},{x:c+o+8,y:p+n},{x:c-8,y:p+n},{x:c-8,y:p},{x:c,y:p},{x:c,y:p+n}],m=g.polygon(y.map(x=>[x.x,x.y]),u),d=e.insert(()=>m,":first-child");return d.attr("class","basic label-container").attr("style",at(f)),s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),f&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),h.attr("transform",`translate(${-o/2+4+(t.padding??0)-(i.x-(i.left??0))},${-n/2+(t.padding??0)-(i.y-(i.top??0))})`),H(t,d),t.intersect=function(x){return N.rect(t,x)},e})}k(Ws,"shadedProcess");function Hs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),o=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=-a/2,c=-o/2,{cssStyles:p}=t,f=M.svg(e),g=A(t,{});t.look!=="handDrawn"&&(g.roughness=0,g.fillStyle="solid");let u=[{x:n,y:c},{x:n,y:c+o},{x:n+a,y:c+o},{x:n+a,y:c-o/2}],y=Z(u),m=f.path(y,g),d=e.insert(()=>m,":first-child");return d.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",p),s&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",s),d.attr("transform",`translate(0, ${o/4})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(i.x-(i.left??0))}, ${-o/4+(t.padding??0)-(i.y-(i.top??0))})`),H(t,d),t.intersect=function(x){return N.polygon(t,u,x)},e})}k(Hs,"slopedRect");function Is(l,t){return L(this,null,function*(){let r={rx:0,ry:0,classes:"",labelPaddingX:(t?.padding||0)*2,labelPaddingY:(t?.padding||0)*1};return Tt(l,t,r)})}k(Is,"squareRect");function Es(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=i.height+t.padding,a=i.width+h/4+t.padding,o,{cssStyles:n}=t;if(t.look==="handDrawn"){let c=M.svg(e),p=A(t,{}),f=pt(-a/2,-h/2,a,h,h/2),g=c.path(f,p);o=e.insert(()=>g,":first-child"),o.attr("class","basic label-container").attr("style",at(n))}else o=e.insert("rect",":first-child"),o.attr("class","basic label-container").attr("style",s).attr("rx",h/2).attr("ry",h/2).attr("x",-a/2).attr("y",-h/2).attr("width",a).attr("height",h);return H(t,o),t.intersect=function(c){return N.rect(t,c)},e})}k(Es,"stadium");function Os(l,t){return L(this,null,function*(){return Tt(l,t,{rx:5,ry:5,classes:"flowchart-node"})})}k(Os,"state");function _s(l,t,{config:{themeVariables:r}}){let{labelStyles:s,nodeStyles:e}=W(t);t.labelStyle=s;let{cssStyles:i}=t,{lineColor:h,stateBorder:a,nodeBorder:o}=r,n=l.insert("g").attr("class","node default").attr("id",t.domId||t.id),c=M.svg(n),p=A(t,{});t.look!=="handDrawn"&&(p.roughness=0,p.fillStyle="solid");let f=c.circle(0,0,14,lt(st({},p),{stroke:h,strokeWidth:2})),g=a??o,u=c.circle(0,0,5,lt(st({},p),{fill:g,stroke:g,strokeWidth:2,fillStyle:"solid"})),y=n.insert(()=>f,":first-child");return y.insert(()=>u),i&&y.selectAll("path").attr("style",i),e&&y.selectAll("path").attr("style",e),H(t,y),t.intersect=function(m){return N.circle(t,7,m)},n}k(_s,"stateEnd");function zs(l,t,{config:{themeVariables:r}}){let{lineColor:s}=r,e=l.insert("g").attr("class","node default").attr("id",t.domId||t.id),i;if(t.look==="handDrawn"){let a=M.svg(e).circle(0,0,14,ve(s));i=e.insert(()=>a),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else i=e.insert("circle",":first-child"),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return H(t,i),t.intersect=function(h){return N.circle(t,7,h)},e}k(zs,"stateStart");function js(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=(t?.padding||0)/2,a=i.width+t.padding,o=i.height+t.padding,n=-i.width/2-h,c=-i.height/2-h,p=[{x:0,y:0},{x:a,y:0},{x:a,y:-o},{x:0,y:-o},{x:0,y:0},{x:-8,y:0},{x:a+8,y:0},{x:a+8,y:-o},{x:-8,y:-o},{x:-8,y:0}];if(t.look==="handDrawn"){let f=M.svg(e),g=A(t,{}),u=f.rectangle(n-8,c,a+16,o,g),y=f.line(n,c,n,c+o,g),m=f.line(n+a,c,n+a,c+o,g);e.insert(()=>y,":first-child"),e.insert(()=>m,":first-child");let d=e.insert(()=>u,":first-child"),{cssStyles:x}=t;d.attr("class","basic label-container").attr("style",at(x)),H(t,d)}else{let f=ft(e,a,o,p);s&&f.attr("style",s),H(t,f)}return t.intersect=function(f){return N.polygon(t,p,f)},e})}k(js,"subroutine");function Gs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=Math.max(i.width+(t.padding??0)*2,t?.width??0),a=Math.max(i.height+(t.padding??0)*2,t?.height??0),o=-h/2,n=-a/2,c=.2*a,p=.2*a,{cssStyles:f}=t,g=M.svg(e),u=A(t,{}),y=[{x:o-c/2,y:n},{x:o+h+c/2,y:n},{x:o+h+c/2,y:n+a},{x:o-c/2,y:n+a}],m=[{x:o+h-c/2,y:n+a},{x:o+h+c/2,y:n+a},{x:o+h+c/2,y:n+a-p}];t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=Z(y),x=g.path(d,u),w=Z(m),b=g.path(w,lt(st({},u),{fillStyle:"solid"})),v=e.insert(()=>b,":first-child");return v.insert(()=>x,":first-child"),v.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",s),H(t,v),t.intersect=function(S){return N.polygon(t,y,S)},e})}k(Gs,"taggedRect");function Fs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),o=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=o/4,c=.2*a,p=.2*o,f=o+n,{cssStyles:g}=t,u=M.svg(e),y=A(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");let m=[{x:-a/2-a/2*.1,y:f/2},...mt(-a/2-a/2*.1,f/2,a/2+a/2*.1,f/2,n,.8),{x:a/2+a/2*.1,y:-f/2},{x:-a/2-a/2*.1,y:-f/2}],d=-a/2+a/2*.1,x=-f/2-p*.4,w=[{x:d+a-c,y:(x+o)*1.4},{x:d+a,y:x+o-p},{x:d+a,y:(x+o)*.9},...mt(d+a,(x+o)*1.3,d+a-c,(x+o)*1.5,-o*.03,.5)],b=Z(m),v=u.path(b,y),S=Z(w),D=u.path(S,lt(st({},y),{fillStyle:"solid"})),$=e.insert(()=>D,":first-child");return $.insert(()=>v,":first-child"),$.attr("class","basic label-container"),g&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",g),s&&t.look!=="handDrawn"&&$.selectAll("path").attr("style",s),$.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(i.x-(i.left??0))},${-o/2+(t.padding??0)-n/2-(i.y-(i.top??0))})`),H(t,$),t.intersect=function(P){return N.polygon(t,m,P)},e})}k(Fs,"taggedWaveEdgedRectangle");function qs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=Math.max(i.width+t.padding,t?.width||0),a=Math.max(i.height+t.padding,t?.height||0),o=-h/2,n=-a/2,c=e.insert("rect",":first-child");return c.attr("class","text").attr("style",s).attr("rx",0).attr("ry",0).attr("x",o).attr("y",n).attr("width",h).attr("height",a),H(t,c),t.intersect=function(p){return N.rect(t,p)},e})}k(qs,"text");var Na=k((l,t,r,s,e,i)=>`M${l},${t}
    a${e},${i} 0,0,1 0,${-s}
    l${r},0
    a${e},${i} 0,0,1 0,${s}
    M${r},${-s}
    a${e},${i} 0,0,0 0,${s}
    l${-r},0`,"createCylinderPathD"),Aa=k((l,t,r,s,e,i)=>[`M${l},${t}`,`M${l+r},${t}`,`a${e},${i} 0,0,0 0,${-s}`,`l${-r},0`,`a${e},${i} 0,0,0 0,${s}`,`l${r},0`].join(" "),"createOuterCylinderPathD"),Ta=k((l,t,r,s,e,i)=>[`M${l+r/2},${-s/2}`,`a${e},${i} 0,0,0 0,${s}`].join(" "),"createInnerCylinderPathD");function Xs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h,halfPadding:a}=yield X(l,t,G(t)),o=t.look==="neo"?a*2:a,n=i.height+o,c=n/2,p=c/(2.5+n/50),f=i.width+p+o,{cssStyles:g}=t,u;if(t.look==="handDrawn"){let y=M.svg(e),m=Aa(0,0,f,n,p,c),d=Ta(0,0,f,n,p,c),x=y.path(m,A(t,{})),w=y.path(d,A(t,{fill:"none"}));u=e.insert(()=>w,":first-child"),u=e.insert(()=>x,":first-child"),u.attr("class","basic label-container"),g&&u.attr("style",g)}else{let y=Na(0,0,f,n,p,c);u=e.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",at(g)).attr("style",s),u.attr("class","basic label-container"),g&&u.selectAll("path").attr("style",g),s&&u.selectAll("path").attr("style",s)}return u.attr("label-offset-x",p),u.attr("transform",`translate(${-f/2}, ${n/2} )`),h.attr("transform",`translate(${-(i.width/2)-p-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),H(t,u),t.intersect=function(y){let m=N.rect(t,y),d=m.y-(t.y??0);if(c!=0&&(Math.abs(d)<(t.height??0)/2||Math.abs(d)==(t.height??0)/2&&Math.abs(m.x-(t.x??0))>(t.width??0)/2-p)){let x=p*p*(1-d*d/(c*c));x!=0&&(x=Math.sqrt(Math.abs(x))),x=p-x,y.x-(t.x??0)>0&&(x=-x),m.x+=x}return m},e})}k(Xs,"tiltedCylinder");function Ys(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=i.width+t.padding,a=i.height+t.padding,o=[{x:-3*a/6,y:0},{x:h+3*a/6,y:0},{x:h,y:-a},{x:0,y:-a}],n,{cssStyles:c}=t;if(t.look==="handDrawn"){let p=M.svg(e),f=A(t,{}),g=Z(o),u=p.path(g,f);n=e.insert(()=>u,":first-child").attr("transform",`translate(${-h/2}, ${a/2})`),c&&n.attr("style",c)}else n=ft(e,h,a,o);return s&&n.attr("style",s),t.width=h,t.height=a,H(t,n),t.intersect=function(p){return N.polygon(t,o,p)},e})}k(Ys,"trapezoid");function Vs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=60,a=20,o=Math.max(h,i.width+(t.padding??0)*2,t?.width??0),n=Math.max(a,i.height+(t.padding??0)*2,t?.height??0),{cssStyles:c}=t,p=M.svg(e),f=A(t,{});t.look!=="handDrawn"&&(f.roughness=0,f.fillStyle="solid");let g=[{x:-o/2*.8,y:-n/2},{x:o/2*.8,y:-n/2},{x:o/2,y:-n/2*.6},{x:o/2,y:n/2},{x:-o/2,y:n/2},{x:-o/2,y:-n/2*.6}],u=Z(g),y=p.path(u,f),m=e.insert(()=>y,":first-child");return m.attr("class","basic label-container"),c&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",c),s&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",s),H(t,m),t.intersect=function(d){return N.polygon(t,g,d)},e})}k(Vs,"trapezoidalPentagon");function Zs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=tt(U().flowchart?.htmlLabels),o=i.width+(t.padding??0),n=o+i.height,c=o+i.height,p=[{x:0,y:0},{x:c,y:0},{x:c/2,y:-n}],{cssStyles:f}=t,g=M.svg(e),u=A(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=Z(p),m=g.path(y,u),d=e.insert(()=>m,":first-child").attr("transform",`translate(${-n/2}, ${n/2})`);return f&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",f),s&&t.look!=="handDrawn"&&d.selectChildren("path").attr("style",s),t.width=o,t.height=n,H(t,d),h.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${n/2-(i.height+(t.padding??0)/(a?2:1)-(i.y-(i.top??0)))})`),t.intersect=function(x){return Q.info("Triangle intersect",t,p,x),N.polygon(t,p,x)},e})}k(Zs,"triangle");function Qs(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),o=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=o/8,c=o+n,{cssStyles:p}=t,g=70-a,u=g>0?g/2:0,y=M.svg(e),m=A(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");let d=[{x:-a/2-u,y:c/2},...mt(-a/2-u,c/2,a/2+u,c/2,n,.8),{x:a/2+u,y:-c/2},{x:-a/2-u,y:-c/2}],x=Z(d),w=y.path(x,m),b=e.insert(()=>w,":first-child");return b.attr("class","basic label-container"),p&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",p),s&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",s),b.attr("transform",`translate(0,${-n/2})`),h.attr("transform",`translate(${-a/2+(t.padding??0)-(i.x-(i.left??0))},${-o/2+(t.padding??0)-n-(i.y-(i.top??0))})`),H(t,b),t.intersect=function(v){return N.polygon(t,d,v)},e})}k(Qs,"waveEdgedRectangle");function Js(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i}=yield X(l,t,G(t)),h=100,a=50,o=Math.max(i.width+(t.padding??0)*2,t?.width??0),n=Math.max(i.height+(t.padding??0)*2,t?.height??0),c=o/n,p=o,f=n;p>f*c?f=p/c:p=f*c,p=Math.max(p,h),f=Math.max(f,a);let g=Math.min(f*.2,f/4),u=f+g*2,{cssStyles:y}=t,m=M.svg(e),d=A(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");let x=[{x:-p/2,y:u/2},...mt(-p/2,u/2,p/2,u/2,g,1),{x:p/2,y:-u/2},...mt(p/2,-u/2,-p/2,-u/2,g,-1)],w=Z(x),b=m.path(w,d),v=e.insert(()=>b,":first-child");return v.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",y),s&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",s),H(t,v),t.intersect=function(S){return N.polygon(t,x,S)},e})}k(Js,"waveRectangle");function Ks(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let{shapeSvg:e,bbox:i,label:h}=yield X(l,t,G(t)),a=Math.max(i.width+(t.padding??0)*2,t?.width??0),o=Math.max(i.height+(t.padding??0)*2,t?.height??0),n=5,c=-a/2,p=-o/2,{cssStyles:f}=t,g=M.svg(e),u=A(t,{}),y=[{x:c-n,y:p-n},{x:c-n,y:p+o},{x:c+a,y:p+o},{x:c+a,y:p-n}],m=`M${c-n},${p-n} L${c+a},${p-n} L${c+a},${p+o} L${c-n},${p+o} L${c-n},${p-n}
                M${c-n},${p} L${c+a},${p}
                M${c},${p-n} L${c},${p+o}`;t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let d=g.path(m,u),x=e.insert(()=>d,":first-child");return x.attr("transform",`translate(${n/2}, ${n/2})`),x.attr("class","basic label-container"),f&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",f),s&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",s),h.attr("transform",`translate(${-(i.width/2)+n/2-(i.x-(i.left??0))}, ${-(i.height/2)+n/2-(i.y-(i.top??0))})`),H(t,x),t.intersect=function(w){return N.polygon(t,y,w)},e})}k(Ks,"windowPane");function be(l,t){return L(this,null,function*(){let r=t;if(r.alias&&(t.label=r.alias),t.look==="handDrawn"){let{themeVariables:Y}=wt(),{background:J}=Y,rt=lt(st({},t),{id:t.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${J}`]});yield be(l,rt)}let s=wt();t.useHtmlLabels=s.htmlLabels;let e=s.er?.diagramPadding??10,i=s.er?.entityPadding??6,{cssStyles:h}=t,{labelStyles:a,nodeStyles:o}=W(t);if(r.attributes.length===0&&t.label){let Y={rx:0,ry:0,labelPaddingX:e,labelPaddingY:e*1.5,classes:""};Pt(t.label,s)+Y.labelPaddingX*2<s.er.minEntityWidth&&(t.width=s.er.minEntityWidth);let J=yield Tt(l,t,Y);if(!tt(s.htmlLabels)){let rt=J.select("text"),nt=rt.node()?.getBBox();rt.attr("transform",`translate(${-nt.width/2}, 0)`)}return J}s.htmlLabels||(e*=1.25,i*=1.25);let n=G(t);n||(n="node default");let c=l.insert("g").attr("class",n).attr("id",t.domId||t.id),p=yield vt(c,t.label??"",s,0,0,["name"],a);p.height+=i;let f=0,g=[],u=[],y=0,m=0,d=0,x=0,w=!0,b=!0;for(let Y of r.attributes){let J=yield vt(c,Y.type,s,0,f,["attribute-type"],a);y=Math.max(y,J.width+e);let rt=yield vt(c,Y.name,s,0,f,["attribute-name"],a);m=Math.max(m,rt.width+e);let nt=yield vt(c,Y.keys.join(),s,0,f,["attribute-keys"],a);d=Math.max(d,nt.width+e);let xt=yield vt(c,Y.comment,s,0,f,["attribute-comment"],a);x=Math.max(x,xt.width+e);let ut=Math.max(J.height,rt.height,nt.height,xt.height)+i;u.push({yOffset:f,rowHeight:ut}),f+=ut}let v=4;d<=e&&(w=!1,d=0,v--),x<=e&&(b=!1,x=0,v--);let S=c.node().getBBox();if(p.width+e*2-(y+m+d+x)>0){let Y=p.width+e*2-(y+m+d+x);y+=Y/v,m+=Y/v,d>0&&(d+=Y/v),x>0&&(x+=Y/v)}let D=y+m+d+x,$=M.svg(c),P=A(t,{});t.look!=="handDrawn"&&(P.roughness=0,P.fillStyle="solid");let C=0;u.length>0&&(C=u.reduce((Y,J)=>Y+(J?.rowHeight??0),0));let O=Math.max(S.width+e*2,t?.width||0,D),V=Math.max((C??0)+p.height,t?.height||0),E=-O/2,B=-V/2;c.selectAll("g:not(:first-child)").each((Y,J,rt)=>{let nt=K(rt[J]),xt=nt.attr("transform"),ut=0,we=0;if(xt){let qt=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(xt);qt&&(ut=parseFloat(qt[1]),we=parseFloat(qt[2]),nt.attr("class").includes("attribute-name")?ut+=y:nt.attr("class").includes("attribute-keys")?ut+=y+m:nt.attr("class").includes("attribute-comment")&&(ut+=y+m+d))}nt.attr("transform",`translate(${E+e/2+ut}, ${we+B+p.height+i/2})`)}),c.select(".name").attr("transform","translate("+-p.width/2+", "+(B+i/2)+")");let I=$.rectangle(E,B,O,V,P),R=c.insert(()=>I,":first-child").attr("style",h.join("")),{themeVariables:q}=wt(),{rowEven:z,rowOdd:T,nodeBorder:F}=q;g.push(0);for(let[Y,J]of u.entries()){let nt=(Y+1)%2===0&&J.yOffset!==0,xt=$.rectangle(E,p.height+B+J?.yOffset,O,J?.rowHeight,lt(st({},P),{fill:nt?z:T,stroke:F}));c.insert(()=>xt,"g.label").attr("style",h.join("")).attr("class",`row-rect-${nt?"even":"odd"}`)}let _=$.line(E,p.height+B,O+E,p.height+B,P);c.insert(()=>_).attr("class","divider"),_=$.line(y+E,p.height+B,y+E,V+B,P),c.insert(()=>_).attr("class","divider"),w&&(_=$.line(y+m+E,p.height+B,y+m+E,V+B,P),c.insert(()=>_).attr("class","divider")),b&&(_=$.line(y+m+d+E,p.height+B,y+m+d+E,V+B,P),c.insert(()=>_).attr("class","divider"));for(let Y of g)_=$.line(E,p.height+B+Y,O+E,p.height+B+Y,P),c.insert(()=>_).attr("class","divider");if(H(t,R),o&&t.look!=="handDrawn"){let J=o.split(";")?.filter(rt=>rt.includes("stroke"))?.map(rt=>`${rt}`).join("; ");c.selectAll("path").attr("style",J??""),c.selectAll(".row-rect-even path").attr("style",o)}return t.intersect=function(Y){return N.rect(t,Y)},c})}k(be,"erBox");function vt(a,o,n){return L(this,arguments,function*(l,t,r,s=0,e=0,i=[],h=""){let c=l.insert("g").attr("class",`label ${i.join(" ")}`).attr("transform",`translate(${s}, ${e})`).attr("style",h);t!==Yt(t)&&(t=Yt(t),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"));let p=c.node().appendChild(yield yt(c,t,{width:Pt(t,r)+100,style:h,useHtmlLabels:r.htmlLabels},r));if(t.includes("&lt;")||t.includes("&gt;")){let g=p.children[0];for(g.textContent=g.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");g.childNodes[0];)g=g.childNodes[0],g.textContent=g.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let f=p.getBBox();if(tt(r.htmlLabels)){let g=p.children[0];g.style.textAlign="start";let u=K(p);f=g.getBoundingClientRect(),u.attr("width",f.width),u.attr("height",f.height)}return f})}k(vt,"addText");function Us(i,h,a,o){return L(this,arguments,function*(l,t,r,s,e=r.class.padding??12){let n=s?0:3,c=l.insert("g").attr("class",G(t)).attr("id",t.domId||t.id),p=null,f=null,g=null,u=null,y=0,m=0,d=0;if(p=c.insert("g").attr("class","annotation-group text"),t.annotations.length>0){let S=t.annotations[0];yield At(p,{text:`\xAB${S}\xBB`},0),y=p.node().getBBox().height}f=c.insert("g").attr("class","label-group text"),yield At(f,t,0,["font-weight: bolder"]);let x=f.node().getBBox();m=x.height,g=c.insert("g").attr("class","members-group text");let w=0;for(let S of t.members){let D=yield At(g,S,w,[S.parseClassifier()]);w+=D+n}d=g.node().getBBox().height,d<=0&&(d=e/2),u=c.insert("g").attr("class","methods-group text");let b=0;for(let S of t.methods){let D=yield At(u,S,b,[S.parseClassifier()]);b+=D+n}let v=c.node().getBBox();if(p!==null){let S=p.node().getBBox();p.attr("transform",`translate(${-S.width/2})`)}return f.attr("transform",`translate(${-x.width/2}, ${y})`),v=c.node().getBBox(),g.attr("transform",`translate(0, ${y+m+e*2})`),v=c.node().getBBox(),u.attr("transform",`translate(0, ${y+m+(d?d+e*4:e*2)})`),v=c.node().getBBox(),{shapeSvg:c,bbox:v}})}k(Us,"textHelper");function At(e,i,h){return L(this,arguments,function*(l,t,r,s=[]){let a=l.insert("g").attr("class","label").attr("style",s.join("; ")),o=wt(),n="useHtmlLabels"in t?t.useHtmlLabels:tt(o.htmlLabels)??!0,c="";"text"in t?c=t.text:c=t.label,!n&&c.startsWith("\\")&&(c=c.substring(1)),Vt(c)&&(n=!0);let p=yield yt(a,Zt(St(c)),{width:Pt(c,o)+50,classes:"markdown-node-label",useHtmlLabels:n},o),f,g=1;if(n){let u=p.children[0],y=K(p);g=u.innerHTML.split("<br>").length,u.innerHTML.includes("</math>")&&(g+=u.innerHTML.split("<mrow>").length-1);let m=u.getElementsByTagName("img");if(m){let d=c.replace(/<img[^>]*>/g,"").trim()==="";yield Promise.all([...m].map(x=>new Promise(w=>{function b(){if(x.style.display="flex",x.style.flexDirection="column",d){let v=o.fontSize?.toString()??window.getComputedStyle(document.body).fontSize,D=parseInt(v,10)*5+"px";x.style.minWidth=D,x.style.maxWidth=D}else x.style.width="100%";w(x)}k(b,"setupImage"),setTimeout(()=>{x.complete&&b()}),x.addEventListener("error",b),x.addEventListener("load",b)})))}f=u.getBoundingClientRect(),y.attr("width",f.width),y.attr("height",f.height)}else{s.includes("font-weight: bolder")&&K(p).selectAll("tspan").attr("font-weight",""),g=p.children.length;let u=p.children[0];(p.textContent===""||p.textContent.includes("&gt"))&&(u.textContent=c[0]+c.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),c[1]===" "&&(u.textContent=u.textContent[0]+" "+u.textContent.substring(1))),u.textContent==="undefined"&&(u.textContent=""),f=p.getBBox()}return a.attr("transform","translate(0,"+(-f.height/(2*g)+r)+")"),f.height})}k(At,"addText");function ta(l,t){return L(this,null,function*(){let r=U(),s=r.class.padding??12,e=s,i=t.useHtmlLabels??tt(r.htmlLabels)??!0,h=t;h.annotations=h.annotations??[],h.members=h.members??[],h.methods=h.methods??[];let{shapeSvg:a,bbox:o}=yield Us(l,t,r,i,e),{labelStyles:n,nodeStyles:c}=W(t);t.labelStyle=n,t.cssStyles=h.styles||"";let p=h.styles?.join(";")||c||"";t.cssStyles||(t.cssStyles=p.replaceAll("!important","").split(";"));let f=h.members.length===0&&h.methods.length===0&&!r.class?.hideEmptyMembersBox,g=M.svg(a),u=A(t,{});t.look!=="handDrawn"&&(u.roughness=0,u.fillStyle="solid");let y=o.width,m=o.height;h.members.length===0&&h.methods.length===0?m+=e:h.members.length>0&&h.methods.length===0&&(m+=e*2);let d=-y/2,x=-m/2,w=g.rectangle(d-s,x-s-(f?s:h.members.length===0&&h.methods.length===0?-s/2:0),y+2*s,m+2*s+(f?s*2:h.members.length===0&&h.methods.length===0?-s:0),u),b=a.insert(()=>w,":first-child");b.attr("class","basic label-container");let v=b.node().getBBox();a.selectAll(".text").each((P,C,O)=>{let V=K(O[C]),E=V.attr("transform"),B=0;if(E){let z=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(E);z&&(B=parseFloat(z[2]))}let I=B+x+s-(f?s:h.members.length===0&&h.methods.length===0?-s/2:0);i||(I-=4);let R=d;(V.attr("class").includes("label-group")||V.attr("class").includes("annotation-group"))&&(R=-V.node()?.getBBox().width/2||0,a.selectAll("text").each(function(q,z,T){window.getComputedStyle(T[z]).textAnchor==="middle"&&(R=0)})),V.attr("transform",`translate(${R}, ${I})`)});let S=a.select(".annotation-group").node().getBBox().height-(f?s/2:0)||0,D=a.select(".label-group").node().getBBox().height-(f?s/2:0)||0,$=a.select(".members-group").node().getBBox().height-(f?s/2:0)||0;if(h.members.length>0||h.methods.length>0||f){let P=g.line(v.x,S+D+x+s,v.x+v.width,S+D+x+s,u);a.insert(()=>P).attr("class","divider").attr("style",p)}if(f||h.members.length>0||h.methods.length>0){let P=g.line(v.x,S+D+$+x+e*2+s,v.x+v.width,S+D+$+x+s+e*2,u);a.insert(()=>P).attr("class","divider").attr("style",p)}if(h.look!=="handDrawn"&&a.selectAll("path").attr("style",p),b.select(":nth-child(2)").attr("style",p),a.selectAll(".divider").select("path").attr("style",p),t.labelStyle?a.selectAll("span").attr("style",t.labelStyle):a.selectAll("span").attr("style",p),!i){let P=RegExp(/color\s*:\s*([^;]*)/),C=P.exec(p);if(C){let O=C[0].replace("color","fill");a.selectAll("tspan").attr("style",O)}else if(n){let O=P.exec(n);if(O){let V=O[0].replace("color","fill");a.selectAll("tspan").attr("style",V)}}}return H(t,b),t.intersect=function(P){return N.rect(t,P)},a})}k(ta,"classBox");function ea(l,t){return L(this,null,function*(){let{labelStyles:r,nodeStyles:s}=W(t);t.labelStyle=r;let e=t,i=t,h=20,a=20,o="verifyMethod"in t,n=G(t),c=l.insert("g").attr("class",n).attr("id",t.domId??t.id),p;o?p=yield ot(c,`&lt;&lt;${e.type}&gt;&gt;`,0,t.labelStyle):p=yield ot(c,"&lt;&lt;Element&gt;&gt;",0,t.labelStyle);let f=p,g=yield ot(c,e.name,f,t.labelStyle+"; font-weight: bold;");if(f+=g+a,o){let S=yield ot(c,`${e.requirementId?`id: ${e.requirementId}`:""}`,f,t.labelStyle);f+=S;let D=yield ot(c,`${e.text?`Text: ${e.text}`:""}`,f,t.labelStyle);f+=D;let $=yield ot(c,`${e.risk?`Risk: ${e.risk}`:""}`,f,t.labelStyle);f+=$,yield ot(c,`${e.verifyMethod?`Verification: ${e.verifyMethod}`:""}`,f,t.labelStyle)}else{let S=yield ot(c,`${i.type?`Type: ${i.type}`:""}`,f,t.labelStyle);f+=S,yield ot(c,`${i.docRef?`Doc Ref: ${i.docRef}`:""}`,f,t.labelStyle)}let u=(c.node()?.getBBox().width??200)+h,y=(c.node()?.getBBox().height??200)+h,m=-u/2,d=-y/2,x=M.svg(c),w=A(t,{});t.look!=="handDrawn"&&(w.roughness=0,w.fillStyle="solid");let b=x.rectangle(m,d,u,y,w),v=c.insert(()=>b,":first-child");if(v.attr("class","basic label-container").attr("style",s),c.selectAll(".label").each((S,D,$)=>{let P=K($[D]),C=P.attr("transform"),O=0,V=0;if(C){let R=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(C);R&&(O=parseFloat(R[1]),V=parseFloat(R[2]))}let E=V-y/2,B=m+h/2;(D===0||D===1)&&(B=O),P.attr("transform",`translate(${B}, ${E+h})`)}),f>p+g+a){let S=x.line(m,d+p+g+a,m+u,d+p+g+a,w);c.insert(()=>S).attr("style",s)}return H(t,v),t.intersect=function(S){return N.rect(t,S)},c})}k(ea,"requirementBox");function ot(l,t,r,s=""){return L(this,null,function*(){if(t==="")return 0;let e=l.insert("g").attr("class","label").attr("style",s),i=U(),h=i.htmlLabels??!0,a=yield yt(e,Zt(St(t)),{width:Pt(t,i)+50,classes:"markdown-node-label",useHtmlLabels:h,style:s},i),o;if(h){let n=a.children[0],c=K(a);o=n.getBoundingClientRect(),c.attr("width",o.width),c.attr("height",o.height)}else{let n=a.children[0];for(let c of n.children)c.textContent=c.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),s&&c.setAttribute("style",s);o=a.getBBox(),o.height+=6}return e.attr("transform",`translate(${-o.width/2},${-o.height/2+r})`),o.height})}k(ot,"addText");var Wa=k(l=>{switch(l){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");function sa(s,e,i){return L(this,arguments,function*(l,t,{config:r}){let{labelStyles:h,nodeStyles:a}=W(t);t.labelStyle=h||"";let o=10,n=t.width;t.width=(t.width??200)-10;let{shapeSvg:c,bbox:p,label:f}=yield X(l,t,G(t)),g=t.padding||10,u="",y;"ticket"in t&&t.ticket&&r?.kanban?.ticketBaseUrl&&(u=r?.kanban?.ticketBaseUrl.replace("#TICKET#",t.ticket),y=c.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",u).attr("target","_blank"));let m={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||"",width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1},d,x;y?{label:d,bbox:x}=yield ue(y,"ticket"in t&&t.ticket||"",m):{label:d,bbox:x}=yield ue(c,"ticket"in t&&t.ticket||"",m);let{label:w,bbox:b}=yield ue(c,"assigned"in t&&t.assigned||"",m);t.width=n;let v=10,S=t?.width||0,D=Math.max(x.height,b.height)/2,$=Math.max(p.height+v*2,t?.height||0)+D,P=-S/2,C=-$/2;f.attr("transform","translate("+(g-S/2)+", "+(-D-p.height/2)+")"),d.attr("transform","translate("+(g-S/2)+", "+(-D+p.height/2)+")"),w.attr("transform","translate("+(g+S/2-b.width-2*o)+", "+(-D+p.height/2)+")");let O,{rx:V,ry:E}=t,{cssStyles:B}=t;if(t.look==="handDrawn"){let I=M.svg(c),R=A(t,{}),q=V||E?I.path(pt(P,C,S,$,V||0),R):I.rectangle(P,C,S,$,R);O=c.insert(()=>q,":first-child"),O.attr("class","basic label-container").attr("style",B||null)}else{O=c.insert("rect",":first-child"),O.attr("class","basic label-container __APA__").attr("style",a).attr("rx",V??5).attr("ry",E??5).attr("x",P).attr("y",C).attr("width",S).attr("height",$);let I="priority"in t&&t.priority;if(I){let R=c.append("line"),q=P+2,z=C+Math.floor((V??0)/2),T=C+$-Math.floor((V??0)/2);R.attr("x1",q).attr("y1",z).attr("x2",q).attr("y2",T).attr("stroke-width","4").attr("stroke",Wa(I))}}return H(t,O),t.height=$,t.intersect=function(I){return N.rect(t,I)},c})}k(sa,"kanbanItem");var Ha=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:Is},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:Ts},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:Es},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:js},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:ls},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:ts},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:Ls},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:us},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:vs},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:Ms},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:Ys},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:Ss},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:os},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:qs},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:Ke},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:Ws},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:zs},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:_s},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:ps},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:ys},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:as},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:rs},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:is},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:$s},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:Qs},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:fs},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:Xs},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:Ds},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:ns},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:cs},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:Zs},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:Ks},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:hs},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:Vs},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:gs},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:Hs},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:Cs},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:Bs},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:Je},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:ss},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:Fs},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:Gs},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:Js},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:Ns},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:Ps}],Ia=k(()=>{let t=[...Object.entries({state:Os,choice:Ue,note:Rs,rectWithTitle:As,labelRect:ks,iconSquare:bs,iconCircle:ms,icon:ds,iconRounded:xs,imageSquare:ws,anchor:Qe,kanbanItem:sa,classBox:ta,erBox:be,requirementBox:ea}),...Ha.flatMap(r=>[r.shortName,..."aliases"in r?r.aliases:[],..."internalAliases"in r?r.internalAliases:[]].map(e=>[e,r.handler]))];return Object.fromEntries(t)},"generateShapeMap"),aa=Ia();function Ea(l){return l in aa}k(Ea,"isValidShape");var Ft=new Map;function Oa(l,t,r){return L(this,null,function*(){let s,e;t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect");let i=t.shape?aa[t.shape]:void 0;if(!i)throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let h;r.config.securityLevel==="sandbox"?h="_top":t.linkTarget&&(h=t.linkTarget||"_blank"),s=l.insert("svg:a").attr("xlink:href",t.link).attr("target",h??null),e=yield i(s,t,r)}else e=yield i(l,t,r),s=e;return t.tooltip&&e.attr("title",t.tooltip),Ft.set(t.id,s),t.haveCallback&&s.attr("class",s.attr("class")+" clickable"),s})}k(Oa,"insertNode");var ni=k((l,t)=>{Ft.set(t.id,l)},"setNodeElem"),li=k(()=>{Ft.clear()},"clear"),ci=k(l=>{let t=Ft.get(l.id);Q.trace("Transforming node",l.diff,l,"translate("+(l.x-l.width/2-5)+", "+l.width/2+")");let r=8,s=l.diff||0;return l.clusterNode?t.attr("transform","translate("+(l.x+s-l.width/2)+", "+(l.y-l.height/2-r)+")"):t.attr("transform","translate("+l.x+", "+l.y+")"),s},"positionNode");export{M as a,X as b,H as c,ye as d,Ja as e,Ka as f,Ea as g,Oa as h,ni as i,li as j,ci as k};
